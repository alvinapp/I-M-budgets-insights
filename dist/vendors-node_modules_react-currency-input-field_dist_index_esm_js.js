"use strict";
(self["webpackChunkbudgets_and_insights"] = self["webpackChunkbudgets_and_insights"] || []).push([["vendors-node_modules_react-currency-input-field_dist_index_esm_js"],{

/***/ "./node_modules/react-currency-input-field/dist/index.esm.js":
/*!*******************************************************************!*\
  !*** ./node_modules/react-currency-input-field/dist/index.esm.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   cleanValue: () => (/* binding */ cleanValue),
/* harmony export */   "default": () => (/* binding */ CurrencyInput),
/* harmony export */   formatValue: () => (/* binding */ formatValue)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);


/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

var __assign = function() {
  __assign = Object.assign || function __assign(t) {
      for (var s, i = 1, n = arguments.length; i < n; i++) {
          s = arguments[i];
          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
      }
      return t;
  };
  return __assign.apply(this, arguments);
};

function __rest(s, e) {
  var t = {};
  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
      t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
              t[p[i]] = s[p[i]];
      }
  return t;
}

function __spreadArray(to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
      if (ar || !(i in from)) {
          if (!ar) ar = Array.prototype.slice.call(from, 0, i);
          ar[i] = from[i];
      }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
}

typeof SuppressedError === "function" ? SuppressedError : function (error, suppressed, message) {
  var e = new Error(message);
  return e.name = "SuppressedError", e.error = error, e.suppressed = suppressed, e;
};

/**
 * Escape regex char
 *
 * See: https://stackoverflow.com/questions/17885855/use-dynamic-variable-string-as-regex-pattern-in-javascript
 */
var escapeRegExp = function (stringToGoIntoTheRegex) {
    return stringToGoIntoTheRegex.replace(/[-/\\^$*+?.()|[\]{}]/g, '\\$&');
};

var abbrMap = { k: 1000, m: 1000000, b: 1000000000 };
/**
 * Parse a value with abbreviation e.g 1k = 1000
 */
var parseAbbrValue = function (value, decimalSeparator) {
    if (decimalSeparator === void 0) { decimalSeparator = '.'; }
    var reg = new RegExp("(\\d+(".concat(escapeRegExp(decimalSeparator), "\\d*)?)([kmb])$"), 'i');
    var match = value.match(reg);
    if (match) {
        var digits = match[1], abbr = match[3];
        var multiplier = abbrMap[abbr.toLowerCase()];
        return Number(digits.replace(decimalSeparator, '.')) * multiplier;
    }
    return undefined;
};

/**
 * Remove group separator from value eg. 1,000 > 1000
 */
var removeSeparators = function (value, separator) {
    if (separator === void 0) { separator = ','; }
    var reg = new RegExp(escapeRegExp(separator), 'g');
    return value.replace(reg, '');
};

/**
 * Remove invalid characters
 */
var removeInvalidChars = function (value, validChars) {
    var chars = escapeRegExp(validChars.join(''));
    var reg = new RegExp("[^\\d".concat(chars, "]"), 'gi');
    return value.replace(reg, '');
};

/**
 * Remove prefix, separators and extra decimals from value
 */
var cleanValue = function (_a) {
    var value = _a.value, _b = _a.groupSeparator, groupSeparator = _b === void 0 ? ',' : _b, _c = _a.decimalSeparator, decimalSeparator = _c === void 0 ? '.' : _c, _d = _a.allowDecimals, allowDecimals = _d === void 0 ? true : _d, _e = _a.decimalsLimit, decimalsLimit = _e === void 0 ? 2 : _e, _f = _a.allowNegativeValue, allowNegativeValue = _f === void 0 ? true : _f, _g = _a.disableAbbreviations, disableAbbreviations = _g === void 0 ? false : _g, _h = _a.prefix, prefix = _h === void 0 ? '' : _h, _j = _a.transformRawValue, transformRawValue = _j === void 0 ? function (rawValue) { return rawValue; } : _j;
    var transformedValue = transformRawValue(value);
    if (transformedValue === '-') {
        return transformedValue;
    }
    var abbreviations = disableAbbreviations ? [] : ['k', 'm', 'b'];
    var reg = new RegExp("((^|\\D)-\\d)|(-".concat(escapeRegExp(prefix), ")"));
    var isNegative = reg.test(transformedValue);
    // Is there a digit before the prefix? eg. 1$
    var _k = RegExp("(\\d+)-?".concat(escapeRegExp(prefix))).exec(value) || [], prefixWithValue = _k[0], preValue = _k[1];
    var withoutPrefix = prefix
        ? prefixWithValue
            ? transformedValue.replace(prefixWithValue, '').concat(preValue)
            : transformedValue.replace(prefix, '')
        : transformedValue;
    var withoutSeparators = removeSeparators(withoutPrefix, groupSeparator);
    var withoutInvalidChars = removeInvalidChars(withoutSeparators, __spreadArray([
        groupSeparator,
        decimalSeparator
    ], abbreviations, true));
    var valueOnly = withoutInvalidChars;
    if (!disableAbbreviations) {
        // disallow letter without number
        if (abbreviations.some(function (letter) { return letter === withoutInvalidChars.toLowerCase().replace(decimalSeparator, ''); })) {
            return '';
        }
        var parsed = parseAbbrValue(withoutInvalidChars, decimalSeparator);
        if (parsed) {
            valueOnly = String(parsed);
        }
    }
    var includeNegative = isNegative && allowNegativeValue ? '-' : '';
    if (decimalSeparator && valueOnly.includes(decimalSeparator)) {
        var _l = withoutInvalidChars.split(decimalSeparator), int = _l[0], decimals = _l[1];
        var trimmedDecimals = decimalsLimit && decimals ? decimals.slice(0, decimalsLimit) : decimals;
        var includeDecimals = allowDecimals ? "".concat(decimalSeparator).concat(trimmedDecimals) : '';
        return "".concat(includeNegative).concat(int).concat(includeDecimals);
    }
    return "".concat(includeNegative).concat(valueOnly);
};

var fixedDecimalValue = function (value, decimalSeparator, fixedDecimalLength) {
    if (fixedDecimalLength !== undefined && value.length > 1) {
        if (fixedDecimalLength === 0) {
            return value.replace(decimalSeparator, '');
        }
        if (value.includes(decimalSeparator)) {
            var _a = value.split(decimalSeparator), int = _a[0], decimals = _a[1];
            if (decimals.length === fixedDecimalLength) {
                return value;
            }
            if (decimals.length > fixedDecimalLength) {
                return "".concat(int).concat(decimalSeparator).concat(decimals.slice(0, fixedDecimalLength));
            }
        }
        var reg = value.length > fixedDecimalLength
            ? new RegExp("(\\d+)(\\d{".concat(fixedDecimalLength, "})"))
            : new RegExp("(\\d)(\\d+)");
        var match = value.match(reg);
        if (match) {
            var int = match[1], decimals = match[2];
            return "".concat(int).concat(decimalSeparator).concat(decimals);
        }
    }
    return value;
};

var getSuffix = function (value, _a) {
    var _b = _a.groupSeparator, groupSeparator = _b === void 0 ? ',' : _b, _c = _a.decimalSeparator, decimalSeparator = _c === void 0 ? '.' : _c;
    var suffixReg = new RegExp("\\d([^".concat(escapeRegExp(groupSeparator)).concat(escapeRegExp(decimalSeparator), "0-9]+)"));
    var suffixMatch = value.match(suffixReg);
    return suffixMatch ? suffixMatch[1] : undefined;
};

/**
 * Format value with decimal separator, group separator and prefix
 */
var formatValue = function (options) {
    var _value = options.value, decimalSeparator = options.decimalSeparator, intlConfig = options.intlConfig, decimalScale = options.decimalScale, _a = options.prefix, prefix = _a === void 0 ? '' : _a, _b = options.suffix, suffix = _b === void 0 ? '' : _b;
    if (_value === '' || _value === undefined) {
        return '';
    }
    if (_value === '-') {
        return '-';
    }
    var isNegative = new RegExp("^\\d?-".concat(prefix ? "".concat(escapeRegExp(prefix), "?") : '', "\\d")).test(_value);
    var value = decimalSeparator !== '.'
        ? replaceDecimalSeparator(_value, decimalSeparator, isNegative)
        : _value;
    if (decimalSeparator && decimalSeparator !== '-' && value.startsWith(decimalSeparator)) {
        value = '0' + value;
    }
    var defaultNumberFormatOptions = {
        minimumFractionDigits: decimalScale || 0,
        maximumFractionDigits: 20,
    };
    var numberFormatter = intlConfig
        ? new Intl.NumberFormat(intlConfig.locale, intlConfig.currency
            ? __assign(__assign({}, defaultNumberFormatOptions), { style: 'currency', currency: intlConfig.currency }) : defaultNumberFormatOptions)
        : new Intl.NumberFormat(undefined, defaultNumberFormatOptions);
    var parts = numberFormatter.formatToParts(Number(value));
    var formatted = replaceParts(parts, options);
    // Does intl formatting add a suffix?
    var intlSuffix = getSuffix(formatted, __assign({}, options));
    // Include decimal separator if user input ends with decimal separator
    var includeDecimalSeparator = _value.slice(-1) === decimalSeparator ? decimalSeparator : '';
    var _c = value.match(RegExp('\\d+\\.(\\d+)')) || [], decimals = _c[1];
    // Keep original decimal padding if no decimalScale
    if (decimalScale === undefined && decimals && decimalSeparator) {
        if (formatted.includes(decimalSeparator)) {
            formatted = formatted.replace(RegExp("(\\d+)(".concat(escapeRegExp(decimalSeparator), ")(\\d+)"), 'g'), "$1$2".concat(decimals));
        }
        else {
            if (intlSuffix && !suffix) {
                formatted = formatted.replace(intlSuffix, "".concat(decimalSeparator).concat(decimals).concat(intlSuffix));
            }
            else {
                formatted = "".concat(formatted).concat(decimalSeparator).concat(decimals);
            }
        }
    }
    if (suffix && includeDecimalSeparator) {
        return "".concat(formatted).concat(includeDecimalSeparator).concat(suffix);
    }
    if (intlSuffix && includeDecimalSeparator) {
        return formatted.replace(intlSuffix, "".concat(includeDecimalSeparator).concat(intlSuffix));
    }
    if (intlSuffix && suffix) {
        return formatted.replace(intlSuffix, "".concat(includeDecimalSeparator).concat(suffix));
    }
    return [formatted, includeDecimalSeparator, suffix].join('');
};
/**
 * Before converting to Number, decimal separator has to be .
 */
var replaceDecimalSeparator = function (value, decimalSeparator, isNegative) {
    var newValue = value;
    if (decimalSeparator && decimalSeparator !== '.') {
        newValue = newValue.replace(RegExp(escapeRegExp(decimalSeparator), 'g'), '.');
        if (isNegative && decimalSeparator === '-') {
            newValue = "-".concat(newValue.slice(1));
        }
    }
    return newValue;
};
var replaceParts = function (parts, _a) {
    var prefix = _a.prefix, groupSeparator = _a.groupSeparator, decimalSeparator = _a.decimalSeparator, decimalScale = _a.decimalScale, _b = _a.disableGroupSeparators, disableGroupSeparators = _b === void 0 ? false : _b;
    return parts
        .reduce(function (prev, _a, i) {
        var type = _a.type, value = _a.value;
        if (i === 0 && prefix) {
            if (type === 'minusSign') {
                return [value, prefix];
            }
            if (type === 'currency') {
                return __spreadArray(__spreadArray([], prev, true), [prefix], false);
            }
            return [prefix, value];
        }
        if (type === 'currency') {
            return prefix ? prev : __spreadArray(__spreadArray([], prev, true), [value], false);
        }
        if (type === 'group') {
            return !disableGroupSeparators
                ? __spreadArray(__spreadArray([], prev, true), [groupSeparator !== undefined ? groupSeparator : value], false) : prev;
        }
        if (type === 'decimal') {
            if (decimalScale !== undefined && decimalScale === 0) {
                return prev;
            }
            return __spreadArray(__spreadArray([], prev, true), [decimalSeparator !== undefined ? decimalSeparator : value], false);
        }
        if (type === 'fraction') {
            return __spreadArray(__spreadArray([], prev, true), [decimalScale !== undefined ? value.slice(0, decimalScale) : value], false);
        }
        return __spreadArray(__spreadArray([], prev, true), [value], false);
    }, [''])
        .join('');
};

var defaultConfig = {
    currencySymbol: '',
    groupSeparator: '',
    decimalSeparator: '',
    prefix: '',
    suffix: '',
};
/**
 * Get locale config from input or default
 */
var getLocaleConfig = function (intlConfig) {
    var _a = intlConfig || {}, locale = _a.locale, currency = _a.currency;
    var numberFormatter = locale
        ? new Intl.NumberFormat(locale, currency ? { currency: currency, style: 'currency' } : undefined)
        : new Intl.NumberFormat();
    return numberFormatter.formatToParts(1000.1).reduce(function (prev, curr, i) {
        if (curr.type === 'currency') {
            if (i === 0) {
                return __assign(__assign({}, prev), { currencySymbol: curr.value, prefix: curr.value });
            }
            else {
                return __assign(__assign({}, prev), { currencySymbol: curr.value, suffix: curr.value });
            }
        }
        if (curr.type === 'group') {
            return __assign(__assign({}, prev), { groupSeparator: curr.value });
        }
        if (curr.type === 'decimal') {
            return __assign(__assign({}, prev), { decimalSeparator: curr.value });
        }
        return prev;
    }, defaultConfig);
};

var isNumber = function (input) { return RegExp(/\d/, 'gi').test(input); };

var padTrimValue = function (value, decimalSeparator, decimalScale) {
    if (decimalSeparator === void 0) { decimalSeparator = '.'; }
    if (decimalScale === undefined || value === '' || value === undefined) {
        return value;
    }
    if (!value.match(/\d/g)) {
        return '';
    }
    var _a = value.split(decimalSeparator), int = _a[0], decimals = _a[1];
    if (decimalScale === 0) {
        return int;
    }
    var newValue = decimals || '';
    if (newValue.length < decimalScale) {
        while (newValue.length < decimalScale) {
            newValue += '0';
        }
    }
    else {
        newValue = newValue.slice(0, decimalScale);
    }
    return "".concat(int).concat(decimalSeparator).concat(newValue);
};

/**
 * Based on the last key stroke and the cursor position, update the value
 * and reposition the cursor to the right place
 */
var repositionCursor = function (_a) {
    var selectionStart = _a.selectionStart, value = _a.value, lastKeyStroke = _a.lastKeyStroke, stateValue = _a.stateValue, groupSeparator = _a.groupSeparator;
    var cursorPosition = selectionStart;
    var modifiedValue = value;
    if (stateValue && cursorPosition) {
        var splitValue = value.split('');
        // if cursor is to right of groupSeparator and backspace pressed, delete the character to the left of the separator and reposition the cursor
        if (lastKeyStroke === 'Backspace' && stateValue[cursorPosition] === groupSeparator) {
            splitValue.splice(cursorPosition - 1, 1);
            cursorPosition -= 1;
        }
        // if cursor is to left of groupSeparator and delete pressed, delete the character to the right of the separator and reposition the cursor
        if (lastKeyStroke === 'Delete' && stateValue[cursorPosition] === groupSeparator) {
            splitValue.splice(cursorPosition, 1);
            cursorPosition += 1;
        }
        modifiedValue = splitValue.join('');
        return { modifiedValue: modifiedValue, cursorPosition: cursorPosition };
    }
    return { modifiedValue: modifiedValue, cursorPosition: selectionStart };
};

var CurrencyInput = (0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(function (_a, ref) {
    var _b = _a.allowDecimals, allowDecimals = _b === void 0 ? true : _b, _c = _a.allowNegativeValue, allowNegativeValue = _c === void 0 ? true : _c, id = _a.id, name = _a.name, className = _a.className, customInput = _a.customInput, decimalsLimit = _a.decimalsLimit, defaultValue = _a.defaultValue, _d = _a.disabled, disabled = _d === void 0 ? false : _d, userMaxLength = _a.maxLength, userValue = _a.value, onValueChange = _a.onValueChange, fixedDecimalLength = _a.fixedDecimalLength, placeholder = _a.placeholder, decimalScale = _a.decimalScale, prefix = _a.prefix, suffix = _a.suffix, intlConfig = _a.intlConfig, step = _a.step, min = _a.min, max = _a.max, _e = _a.disableGroupSeparators, disableGroupSeparators = _e === void 0 ? false : _e, _f = _a.disableAbbreviations, disableAbbreviations = _f === void 0 ? false : _f, _decimalSeparator = _a.decimalSeparator, _groupSeparator = _a.groupSeparator, onChange = _a.onChange, onFocus = _a.onFocus, onBlur = _a.onBlur, onKeyDown = _a.onKeyDown, onKeyUp = _a.onKeyUp, transformRawValue = _a.transformRawValue, _g = _a.formatValueOnBlur, formatValueOnBlur = _g === void 0 ? true : _g, props = __rest(_a, ["allowDecimals", "allowNegativeValue", "id", "name", "className", "customInput", "decimalsLimit", "defaultValue", "disabled", "maxLength", "value", "onValueChange", "fixedDecimalLength", "placeholder", "decimalScale", "prefix", "suffix", "intlConfig", "step", "min", "max", "disableGroupSeparators", "disableAbbreviations", "decimalSeparator", "groupSeparator", "onChange", "onFocus", "onBlur", "onKeyDown", "onKeyUp", "transformRawValue", "formatValueOnBlur"]);
    if (_decimalSeparator && isNumber(_decimalSeparator)) {
        throw new Error('decimalSeparator cannot be a number');
    }
    if (_groupSeparator && isNumber(_groupSeparator)) {
        throw new Error('groupSeparator cannot be a number');
    }
    var localeConfig = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(function () { return getLocaleConfig(intlConfig); }, [intlConfig]);
    var decimalSeparator = _decimalSeparator || localeConfig.decimalSeparator || '';
    var groupSeparator = _groupSeparator || localeConfig.groupSeparator || '';
    if (decimalSeparator &&
        groupSeparator &&
        decimalSeparator === groupSeparator &&
        disableGroupSeparators === false) {
        throw new Error('decimalSeparator cannot be the same as groupSeparator');
    }
    var formatValueOptions = {
        decimalSeparator: decimalSeparator,
        groupSeparator: groupSeparator,
        disableGroupSeparators: disableGroupSeparators,
        intlConfig: intlConfig,
        prefix: prefix || localeConfig.prefix,
        suffix: suffix,
    };
    var cleanValueOptions = {
        decimalSeparator: decimalSeparator,
        groupSeparator: groupSeparator,
        allowDecimals: allowDecimals,
        decimalsLimit: decimalsLimit || fixedDecimalLength || 2,
        allowNegativeValue: allowNegativeValue,
        disableAbbreviations: disableAbbreviations,
        prefix: prefix || localeConfig.prefix,
        transformRawValue: transformRawValue,
    };
    var _h = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(function () {
        return defaultValue != null
            ? formatValue(__assign(__assign({}, formatValueOptions), { decimalScale: decimalScale, value: String(defaultValue) }))
            : userValue != null
                ? formatValue(__assign(__assign({}, formatValueOptions), { decimalScale: decimalScale, value: String(userValue) }))
                : '';
    }), stateValue = _h[0], setStateValue = _h[1];
    var _j = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false), dirty = _j[0], setDirty = _j[1];
    var _k = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0), cursor = _k[0], setCursor = _k[1];
    var _l = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0), changeCount = _l[0], setChangeCount = _l[1];
    var _m = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null), lastKeyStroke = _m[0], setLastKeyStroke = _m[1];
    var inputRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useImperativeHandle)(ref, function () { return inputRef.current; });
    /**
     * Process change in value
     */
    var processChange = function (value, selectionStart) {
        setDirty(true);
        var _a = repositionCursor({
            selectionStart: selectionStart,
            value: value,
            lastKeyStroke: lastKeyStroke,
            stateValue: stateValue,
            groupSeparator: groupSeparator,
        }), modifiedValue = _a.modifiedValue, cursorPosition = _a.cursorPosition;
        var stringValue = cleanValue(__assign({ value: modifiedValue }, cleanValueOptions));
        if (userMaxLength && stringValue.replace(/-/g, '').length > userMaxLength) {
            return;
        }
        if (stringValue === '' || stringValue === '-' || stringValue === decimalSeparator) {
            onValueChange && onValueChange(undefined, name, { float: null, formatted: '', value: '' });
            setStateValue(stringValue);
            // Always sets cursor after '-' or decimalSeparator input
            setCursor(1);
            return;
        }
        var stringValueWithoutSeparator = decimalSeparator
            ? stringValue.replace(decimalSeparator, '.')
            : stringValue;
        var numberValue = parseFloat(stringValueWithoutSeparator);
        var formattedValue = formatValue(__assign({ value: stringValue }, formatValueOptions));
        if (cursorPosition != null) {
            // Prevent cursor jumping
            var newCursor = cursorPosition + (formattedValue.length - value.length);
            newCursor = newCursor <= 0 ? (prefix ? prefix.length : 0) : newCursor;
            setCursor(newCursor);
            setChangeCount(changeCount + 1);
        }
        setStateValue(formattedValue);
        if (onValueChange) {
            var values = {
                float: numberValue,
                formatted: formattedValue,
                value: stringValue,
            };
            onValueChange(stringValue, name, values);
        }
    };
    /**
     * Handle change event
     */
    var handleOnChange = function (event) {
        var _a = event.target, value = _a.value, selectionStart = _a.selectionStart;
        processChange(value, selectionStart);
        onChange && onChange(event);
    };
    /**
     * Handle focus event
     */
    var handleOnFocus = function (event) {
        onFocus && onFocus(event);
        return stateValue ? stateValue.length : 0;
    };
    /**
     * Handle blur event
     *
     * Format value by padding/trimming decimals if required by
     */
    var handleOnBlur = function (event) {
        var value = event.target.value;
        var valueOnly = cleanValue(__assign({ value: value }, cleanValueOptions));
        if (valueOnly === '-' || valueOnly === decimalSeparator || !valueOnly) {
            setStateValue('');
            onBlur && onBlur(event);
            return;
        }
        var fixedDecimals = fixedDecimalValue(valueOnly, decimalSeparator, fixedDecimalLength);
        var newValue = padTrimValue(fixedDecimals, decimalSeparator, decimalScale !== undefined ? decimalScale : fixedDecimalLength);
        var numberValue = parseFloat(newValue.replace(decimalSeparator, '.'));
        var formattedValue = formatValue(__assign(__assign({}, formatValueOptions), { value: newValue }));
        if (onValueChange && formatValueOnBlur) {
            onValueChange(newValue, name, {
                float: numberValue,
                formatted: formattedValue,
                value: newValue,
            });
        }
        setStateValue(formattedValue);
        onBlur && onBlur(event);
    };
    /**
     * Handle key down event
     *
     * Increase or decrease value by step
     */
    var handleOnKeyDown = function (event) {
        var key = event.key;
        setLastKeyStroke(key);
        if (step && (key === 'ArrowUp' || key === 'ArrowDown')) {
            event.preventDefault();
            setCursor(stateValue.length);
            var currentValue = parseFloat(userValue != null
                ? String(userValue).replace(decimalSeparator, '.')
                : cleanValue(__assign({ value: stateValue }, cleanValueOptions))) || 0;
            var newValue = key === 'ArrowUp' ? currentValue + step : currentValue - step;
            if (min !== undefined && newValue < Number(min)) {
                return;
            }
            if (max !== undefined && newValue > Number(max)) {
                return;
            }
            var fixedLength = String(step).includes('.')
                ? Number(String(step).split('.')[1].length)
                : undefined;
            processChange(String(fixedLength ? newValue.toFixed(fixedLength) : newValue).replace('.', decimalSeparator));
        }
        onKeyDown && onKeyDown(event);
    };
    /**
     * Handle key up event
     *
     * Move cursor if there is a suffix to prevent user typing past suffix
     */
    var handleOnKeyUp = function (event) {
        var key = event.key, selectionStart = event.currentTarget.selectionStart;
        if (key !== 'ArrowUp' && key !== 'ArrowDown' && stateValue !== '-') {
            var suffix_1 = getSuffix(stateValue, { groupSeparator: groupSeparator, decimalSeparator: decimalSeparator });
            if (suffix_1 && selectionStart && selectionStart > stateValue.length - suffix_1.length) {
                /* istanbul ignore else */
                if (inputRef.current) {
                    var newCursor = stateValue.length - suffix_1.length;
                    inputRef.current.setSelectionRange(newCursor, newCursor);
                }
            }
        }
        onKeyUp && onKeyUp(event);
    };
    // Update state if userValue changes to undefined
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {
        if (userValue == null && defaultValue == null) {
            setStateValue('');
        }
    }, [defaultValue, userValue]);
    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {
        // prevent cursor jumping if editing value
        if (dirty &&
            stateValue !== '-' &&
            inputRef.current &&
            document.activeElement === inputRef.current) {
            inputRef.current.setSelectionRange(cursor, cursor);
        }
    }, [stateValue, cursor, inputRef, dirty, changeCount]);
    /**
     * If user has only entered "-" or decimal separator,
     * keep the char to allow them to enter next value
     */
    var getRenderValue = function () {
        if (userValue != null &&
            stateValue !== '-' &&
            (!decimalSeparator || stateValue !== decimalSeparator)) {
            return formatValue(__assign(__assign({}, formatValueOptions), { decimalScale: dirty ? undefined : decimalScale, value: String(userValue) }));
        }
        return stateValue;
    };
    var inputProps = __assign({ type: 'text', inputMode: 'decimal', id: id, name: name, className: className, onChange: handleOnChange, onBlur: handleOnBlur, onFocus: handleOnFocus, onKeyDown: handleOnKeyDown, onKeyUp: handleOnKeyUp, placeholder: placeholder, disabled: disabled, value: getRenderValue(), ref: inputRef }, props);
    if (customInput) {
        var CustomInput = customInput;
        return react__WEBPACK_IMPORTED_MODULE_0___default().createElement(CustomInput, __assign({}, inputProps));
    }
    return react__WEBPACK_IMPORTED_MODULE_0___default().createElement("input", __assign({}, inputProps));
});
CurrencyInput.displayName = 'CurrencyInput';




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGRfZGlzdF9pbmRleF9lc21fanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFpQkE7QUFDTyxJQUFJLFFBQVEsR0FBRyxXQUFXO0FBQ2pDLEVBQUUsUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLElBQUksU0FBUyxRQUFRLENBQUMsQ0FBQyxFQUFFO0FBQ25ELE1BQU0sS0FBSyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDM0QsVUFBVSxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNCLFVBQVUsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDdkYsT0FBTztBQUNQLE1BQU0sT0FBTyxDQUFDLENBQUM7QUFDZixJQUFHO0FBQ0gsRUFBRSxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0FBQ3pDLEVBQUM7QUFDRDtBQUNPLFNBQVMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUU7QUFDN0IsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDYixFQUFFLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMs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R0FBRztRQUNyQixJQUNFLFNBQVMsSUFBSSxJQUFJO0FBQ2pCLHNCQUFVLEtBQUssR0FBRzthQUNqQixDQUFDLGdCQUFnQixJQUFJLFVBQVUsS0FBSyxnQkFBZ0IsQ0FBQyxFQUN0RDtZQUNBLE9BQU8sV0FBVyx1QkFDYixrQkFBa0IsS0FDckIsWUFBWSxFQUFFLEtBQUssR0FBRyxTQUFTLEdBQUcsWUFBWSxFQUM5QyxLQUFLLEVBQUUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUN4QixDQUFDO1NBQ0o7QUFFRCxlQUFPLFVBQVUsQ0FBQztBQUNwQixLQUFDLENBQUM7SUFFRixJQUFNLFVBQVUsR0FDZCxlQUFJLEVBQUUsTUFBTSxFQUNaLFNBQVMsRUFBRSxTQUFTLEVBQ3BCLEVBQUUsTUFDRixJQUFJLFFBQ0osU0FBUyxhQUNULFFBQVEsRUFBRSxjQUFjLEVBQ3hCLE1BQU0sRUFBRSxZQUFZLEVBQ3BCLE9BQU8sRUFBRSxhQUFhLEVBQ3RCLFNBQVMsRUFBRSxlQUFlLEVBQzFCLE9BQU8sRUFBRSxhQUFhLEVBQ3RCLFdBQVcsZUFDWCxRQUFRLFlBQ1IsS0FBSyxFQUFFLGNBQWMsRUFBRSxFQUN2QixHQUFHLEVBQUUsUUFBUSxJQUNWLEtBQUssQ0FDVCxDQUFDO0lBRUYsSUFBSSxXQUFXLEVBQUU7UUFDZixJQUFNLFdBQVcsR0FBRyxXQUFXLENBQUM7QUFDaEMsZUFBTywwREFBQyxZQUFXLEVBQUssdUJBQVUsRUFBSSxDQUFDO0tBQ3hDO0lBRUQsT0FBTyxpRkFBVyxVQUFVLEVBQUksQ0FBQztBQUNuQyxDQUFDLEVBQ0Q7QUFFRixhQUFhLENBQUMsV0FBVyxHQUFHLGVBQWUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2Lm1qcyIsIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9zcmMvY29tcG9uZW50cy91dGlscy9lc2NhcGVSZWdFeHAudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0cy1hbmQtaW5zaWdodHMvLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGQvc3JjL2NvbXBvbmVudHMvdXRpbHMvcGFyc2VBYmJyVmFsdWUudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0cy1hbmQtaW5zaWdodHMvLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGQvc3JjL2NvbXBvbmVudHMvdXRpbHMvcmVtb3ZlU2VwYXJhdG9ycy50cyIsIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9zcmMvY29tcG9uZW50cy91dGlscy9yZW1vdmVJbnZhbGlkQ2hhcnMudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0cy1hbmQtaW5zaWdodHMvLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGQvc3JjL2NvbXBvbmVudHMvdXRpbHMvY2xlYW5WYWx1ZS50cyIsIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9zcmMvY29tcG9uZW50cy91dGlscy9maXhlZERlY2ltYWxWYWx1ZS50cyIsIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9zcmMvY29tcG9uZW50cy91dGlscy9nZXRTdWZmaXgudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0cy1hbmQtaW5zaWdodHMvLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGQvc3JjL2NvbXBvbmVudHMvdXRpbHMvZm9ybWF0VmFsdWUudHMiLCJ3ZWJwYWNrOi8vYnVkZ2V0cy1hbmQtaW5zaWdodHMvLi9ub2RlX21vZHVsZXMvcmVhY3QtY3VycmVuY3ktaW5wdXQtZmllbGQvc3JjL2NvbXBvbmVudHMvdXRpbHMvZ2V0TG9jYWxlQ29uZmlnLnRzIiwid2VicGFjazovL2J1ZGdldHMtYW5kLWluc2lnaHRzLy4vbm9kZV9tb2R1bGVzL3JlYWN0LWN1cnJlbmN5LWlucHV0LWZpZWxkL3NyYy9jb21wb25lbnRzL3V0aWxzL2lzTnVtYmVyLnRzIiwid2VicGFjazovL2J1ZGdldHMtYW5kLWluc2lnaHRzLy4vbm9kZV9tb2R1bGVzL3JlYWN0LWN1cnJlbmN5LWlucHV0LWZpZWxkL3NyYy9jb21wb25lbnRzL3V0aWxzL3BhZFRyaW1WYWx1ZS50cyIsIndlYnBhY2s6Ly9idWRnZXRzLWFuZC1pbnNpZ2h0cy8uL25vZGVfbW9kdWxlcy9yZWFjdC1jdXJyZW5jeS1pbnB1dC1maWVsZC9zcmMvY29tcG9uZW50cy91dGlscy9yZXBvc2l0aW9uQ3Vyc29yLnRzIiwid2VicGFjazovL2J1ZGdldHMtYW5kLWluc2lnaHRzLy4vbm9kZV9tb2R1bGVzL3JlYWN0LWN1cnJlbmN5LWlucHV0LWZpZWxkL3NyYy9jb21wb25lbnRzL0N1cnJlbmN5SW5wdXQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxuXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlLCBTdXBwcmVzc2VkRXJyb3IsIFN5bWJvbCAqL1xuXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcbiAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcbiAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbn1cblxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xuICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xuICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHQ7XG4gIH1cbiAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xuICB2YXIgdCA9IHt9O1xuICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcbiAgICAgIHRbcF0gPSBzW3BdO1xuICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXG4gICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxuICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcbiAgICAgIH1cbiAgcmV0dXJuIHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fZXNEZWNvcmF0ZShjdG9yLCBkZXNjcmlwdG9ySW4sIGRlY29yYXRvcnMsIGNvbnRleHRJbiwgaW5pdGlhbGl6ZXJzLCBleHRyYUluaXRpYWxpemVycykge1xuICBmdW5jdGlvbiBhY2NlcHQoZikgeyBpZiAoZiAhPT0gdm9pZCAwICYmIHR5cGVvZiBmICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGdW5jdGlvbiBleHBlY3RlZFwiKTsgcmV0dXJuIGY7IH1cbiAgdmFyIGtpbmQgPSBjb250ZXh0SW4ua2luZCwga2V5ID0ga2luZCA9PT0gXCJnZXR0ZXJcIiA/IFwiZ2V0XCIgOiBraW5kID09PSBcInNldHRlclwiID8gXCJzZXRcIiA6IFwidmFsdWVcIjtcbiAgdmFyIHRhcmdldCA9ICFkZXNjcmlwdG9ySW4gJiYgY3RvciA/IGNvbnRleHRJbltcInN0YXRpY1wiXSA/IGN0b3IgOiBjdG9yLnByb3RvdHlwZSA6IG51bGw7XG4gIHZhciBkZXNjcmlwdG9yID0gZGVzY3JpcHRvckluIHx8ICh0YXJnZXQgPyBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgY29udGV4dEluLm5hbWUpIDoge30pO1xuICB2YXIgXywgZG9uZSA9IGZhbHNlO1xuICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGNvbnRleHQgPSB7fTtcbiAgICAgIGZvciAodmFyIHAgaW4gY29udGV4dEluKSBjb250ZXh0W3BdID0gcCA9PT0gXCJhY2Nlc3NcIiA/IHt9IDogY29udGV4dEluW3BdO1xuICAgICAgZm9yICh2YXIgcCBpbiBjb250ZXh0SW4uYWNjZXNzKSBjb250ZXh0LmFjY2Vzc1twXSA9IGNvbnRleHRJbi5hY2Nlc3NbcF07XG4gICAgICBjb250ZXh0LmFkZEluaXRpYWxpemVyID0gZnVuY3Rpb24gKGYpIHsgaWYgKGRvbmUpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgYWRkIGluaXRpYWxpemVycyBhZnRlciBkZWNvcmF0aW9uIGhhcyBjb21wbGV0ZWRcIik7IGV4dHJhSW5pdGlhbGl6ZXJzLnB1c2goYWNjZXB0KGYgfHwgbnVsbCkpOyB9O1xuICAgICAgdmFyIHJlc3VsdCA9ICgwLCBkZWNvcmF0b3JzW2ldKShraW5kID09PSBcImFjY2Vzc29yXCIgPyB7IGdldDogZGVzY3JpcHRvci5nZXQsIHNldDogZGVzY3JpcHRvci5zZXQgfSA6IGRlc2NyaXB0b3Jba2V5XSwgY29udGV4dCk7XG4gICAgICBpZiAoa2luZCA9PT0gXCJhY2Nlc3NvclwiKSB7XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gdm9pZCAwKSBjb250aW51ZTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsIHx8IHR5cGVvZiByZXN1bHQgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJPYmplY3QgZXhwZWN0ZWRcIik7XG4gICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LmdldCkpIGRlc2NyaXB0b3IuZ2V0ID0gXztcbiAgICAgICAgICBpZiAoXyA9IGFjY2VwdChyZXN1bHQuc2V0KSkgZGVzY3JpcHRvci5zZXQgPSBfO1xuICAgICAgICAgIGlmIChfID0gYWNjZXB0KHJlc3VsdC5pbml0KSkgaW5pdGlhbGl6ZXJzLnVuc2hpZnQoXyk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChfID0gYWNjZXB0KHJlc3VsdCkpIHtcbiAgICAgICAgICBpZiAoa2luZCA9PT0gXCJmaWVsZFwiKSBpbml0aWFsaXplcnMudW5zaGlmdChfKTtcbiAgICAgICAgICBlbHNlIGRlc2NyaXB0b3Jba2V5XSA9IF87XG4gICAgICB9XG4gIH1cbiAgaWYgKHRhcmdldCkgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgY29udGV4dEluLm5hbWUsIGRlc2NyaXB0b3IpO1xuICBkb25lID0gdHJ1ZTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3J1bkluaXRpYWxpemVycyh0aGlzQXJnLCBpbml0aWFsaXplcnMsIHZhbHVlKSB7XG4gIHZhciB1c2VWYWx1ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGluaXRpYWxpemVycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWUgPSB1c2VWYWx1ZSA/IGluaXRpYWxpemVyc1tpXS5jYWxsKHRoaXNBcmcsIHZhbHVlKSA6IGluaXRpYWxpemVyc1tpXS5jYWxsKHRoaXNBcmcpO1xuICB9XG4gIHJldHVybiB1c2VWYWx1ZSA/IHZhbHVlIDogdm9pZCAwO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fcHJvcEtleSh4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gXCJzeW1ib2xcIiA/IHggOiBcIlwiLmNvbmNhdCh4KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3NldEZ1bmN0aW9uTmFtZShmLCBuYW1lLCBwcmVmaXgpIHtcbiAgaWYgKHR5cGVvZiBuYW1lID09PSBcInN5bWJvbFwiKSBuYW1lID0gbmFtZS5kZXNjcmlwdGlvbiA/IFwiW1wiLmNvbmNhdChuYW1lLmRlc2NyaXB0aW9uLCBcIl1cIikgOiBcIlwiO1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KGYsIFwibmFtZVwiLCB7IGNvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHByZWZpeCA/IFwiXCIuY29uY2F0KHByZWZpeCwgXCIgXCIsIG5hbWUpIDogbmFtZSB9KTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XG4gIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XG4gIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcbiAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICB9XG59XG5cbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICB9XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICBvW2syXSA9IG1ba107XG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XG4gIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcbiAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcbiAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgIH1cbiAgfTtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcbiAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICBpZiAoIW0pIHJldHVybiBvO1xuICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgdHJ5IHtcbiAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICB9XG4gIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICBmaW5hbGx5IHtcbiAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICB9XG4gICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgfVxuICByZXR1cm4gYXI7XG59XG5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xuICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcbiAgcmV0dXJuIGFyO1xufVxuXG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcbiAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XG4gIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxuICAgICAgICAgIHJba10gPSBhW2pdO1xuICByZXR1cm4gcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcbiAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgIH1cbiAgfVxuICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xuICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XG4gIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcbiAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XG4gIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cbiAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XG4gIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cbiAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxuICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcbiAgdmFyIGksIHA7XG4gIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XG4gIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IGZhbHNlIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcbiAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcbiAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcbiAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xuICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XG4gIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XG4gIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XG4gIHJldHVybiBjb29rZWQ7XG59O1xuXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcbn0pIDogZnVuY3Rpb24obywgdikge1xuICBvW1wiZGVmYXVsdFwiXSA9IHY7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xuICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICB2YXIgcmVzdWx0ID0ge307XG4gIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcbiAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcbiAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XG4gIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcbiAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcbiAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xuICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XG4gIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEluKHN0YXRlLCByZWNlaXZlcikge1xuICBpZiAocmVjZWl2ZXIgPT09IG51bGwgfHwgKHR5cGVvZiByZWNlaXZlciAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcmVjZWl2ZXIgIT09IFwiZnVuY3Rpb25cIikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgdXNlICdpbicgb3BlcmF0b3Igb24gbm9uLW9iamVjdFwiKTtcbiAgcmV0dXJuIHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgPT09IHN0YXRlIDogc3RhdGUuaGFzKHJlY2VpdmVyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYWRkRGlzcG9zYWJsZVJlc291cmNlKGVudiwgdmFsdWUsIGFzeW5jKSB7XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZC5cIik7XG4gICAgdmFyIGRpc3Bvc2U7XG4gICAgaWYgKGFzeW5jKSB7XG4gICAgICAgIGlmICghU3ltYm9sLmFzeW5jRGlzcG9zZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0Rpc3Bvc2UgaXMgbm90IGRlZmluZWQuXCIpO1xuICAgICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmFzeW5jRGlzcG9zZV07XG4gICAgfVxuICAgIGlmIChkaXNwb3NlID09PSB2b2lkIDApIHtcbiAgICAgICAgaWYgKCFTeW1ib2wuZGlzcG9zZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5kaXNwb3NlIGlzIG5vdCBkZWZpbmVkLlwiKTtcbiAgICAgICAgZGlzcG9zZSA9IHZhbHVlW1N5bWJvbC5kaXNwb3NlXTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBkaXNwb3NlICE9PSBcImZ1bmN0aW9uXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJPYmplY3Qgbm90IGRpc3Bvc2FibGUuXCIpO1xuICAgIGVudi5zdGFjay5wdXNoKHsgdmFsdWU6IHZhbHVlLCBkaXNwb3NlOiBkaXNwb3NlLCBhc3luYzogYXN5bmMgfSk7XG4gIH1cbiAgZWxzZSBpZiAoYXN5bmMpIHtcbiAgICBlbnYuc3RhY2sucHVzaCh7IGFzeW5jOiB0cnVlIH0pO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxudmFyIF9TdXBwcmVzc2VkRXJyb3IgPSB0eXBlb2YgU3VwcHJlc3NlZEVycm9yID09PSBcImZ1bmN0aW9uXCIgPyBTdXBwcmVzc2VkRXJyb3IgOiBmdW5jdGlvbiAoZXJyb3IsIHN1cHByZXNzZWQsIG1lc3NhZ2UpIHtcbiAgdmFyIGUgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIHJldHVybiBlLm5hbWUgPSBcIlN1cHByZXNzZWRFcnJvclwiLCBlLmVycm9yID0gZXJyb3IsIGUuc3VwcHJlc3NlZCA9IHN1cHByZXNzZWQsIGU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19kaXNwb3NlUmVzb3VyY2VzKGVudikge1xuICBmdW5jdGlvbiBmYWlsKGUpIHtcbiAgICBlbnYuZXJyb3IgPSBlbnYuaGFzRXJyb3IgPyBuZXcgX1N1cHByZXNzZWRFcnJvcihlLCBlbnYuZXJyb3IsIFwiQW4gZXJyb3Igd2FzIHN1cHByZXNzZWQgZHVyaW5nIGRpc3Bvc2FsLlwiKSA6IGU7XG4gICAgZW52Lmhhc0Vycm9yID0gdHJ1ZTtcbiAgfVxuICBmdW5jdGlvbiBuZXh0KCkge1xuICAgIHdoaWxlIChlbnYuc3RhY2subGVuZ3RoKSB7XG4gICAgICB2YXIgcmVjID0gZW52LnN0YWNrLnBvcCgpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlYy5kaXNwb3NlICYmIHJlYy5kaXNwb3NlLmNhbGwocmVjLnZhbHVlKTtcbiAgICAgICAgaWYgKHJlYy5hc3luYykgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXN1bHQpLnRoZW4obmV4dCwgZnVuY3Rpb24oZSkgeyBmYWlsKGUpOyByZXR1cm4gbmV4dCgpOyB9KTtcbiAgICAgIH1cbiAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgZmFpbChlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVudi5oYXNFcnJvcikgdGhyb3cgZW52LmVycm9yO1xuICB9XG4gIHJldHVybiBuZXh0KCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgX19leHRlbmRzLFxuICBfX2Fzc2lnbixcbiAgX19yZXN0LFxuICBfX2RlY29yYXRlLFxuICBfX3BhcmFtLFxuICBfX21ldGFkYXRhLFxuICBfX2F3YWl0ZXIsXG4gIF9fZ2VuZXJhdG9yLFxuICBfX2NyZWF0ZUJpbmRpbmcsXG4gIF9fZXhwb3J0U3RhcixcbiAgX192YWx1ZXMsXG4gIF9fcmVhZCxcbiAgX19zcHJlYWQsXG4gIF9fc3ByZWFkQXJyYXlzLFxuICBfX3NwcmVhZEFycmF5LFxuICBfX2F3YWl0LFxuICBfX2FzeW5jR2VuZXJhdG9yLFxuICBfX2FzeW5jRGVsZWdhdG9yLFxuICBfX2FzeW5jVmFsdWVzLFxuICBfX21ha2VUZW1wbGF0ZU9iamVjdCxcbiAgX19pbXBvcnRTdGFyLFxuICBfX2ltcG9ydERlZmF1bHQsXG4gIF9fY2xhc3NQcml2YXRlRmllbGRHZXQsXG4gIF9fY2xhc3NQcml2YXRlRmllbGRTZXQsXG4gIF9fY2xhc3NQcml2YXRlRmllbGRJbixcbiAgX19hZGREaXNwb3NhYmxlUmVzb3VyY2UsXG4gIF9fZGlzcG9zZVJlc291cmNlcyxcbn07XG4iLCIvKipcbiAqIEVzY2FwZSByZWdleCBjaGFyXG4gKlxuICogU2VlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xNzg4NTg1NS91c2UtZHluYW1pYy12YXJpYWJsZS1zdHJpbmctYXMtcmVnZXgtcGF0dGVybi1pbi1qYXZhc2NyaXB0XG4gKi9cbmV4cG9ydCBjb25zdCBlc2NhcGVSZWdFeHAgPSAoc3RyaW5nVG9Hb0ludG9UaGVSZWdleDogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIHN0cmluZ1RvR29JbnRvVGhlUmVnZXgucmVwbGFjZSgvWy0vXFxcXF4kKis/LigpfFtcXF17fV0vZywgJ1xcXFwkJicpO1xufTtcbiIsImltcG9ydCB7IGVzY2FwZVJlZ0V4cCB9IGZyb20gJy4vZXNjYXBlUmVnRXhwJztcblxuLyoqXG4gKiBBYmJyZXZpYXRlIG51bWJlciBlZy4gMTAwMCA9IDFrXG4gKlxuICogU291cmNlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvOTM0NTE4MVxuICovXG5leHBvcnQgY29uc3QgYWJiclZhbHVlID0gKHZhbHVlOiBudW1iZXIsIGRlY2ltYWxTZXBhcmF0b3IgPSAnLicsIF9kZWNpbWFsUGxhY2VzID0gMTApOiBzdHJpbmcgPT4ge1xuICBpZiAodmFsdWUgPiA5OTkpIHtcbiAgICBsZXQgdmFsdWVMZW5ndGggPSAoJycgKyB2YWx1ZSkubGVuZ3RoO1xuICAgIGNvbnN0IHAgPSBNYXRoLnBvdztcbiAgICBjb25zdCBkID0gcCgxMCwgX2RlY2ltYWxQbGFjZXMpO1xuICAgIHZhbHVlTGVuZ3RoIC09IHZhbHVlTGVuZ3RoICUgMztcblxuICAgIGNvbnN0IGFiYnJWYWx1ZSA9IE1hdGgucm91bmQoKHZhbHVlICogZCkgLyBwKDEwLCB2YWx1ZUxlbmd0aCkpIC8gZCArICcga01HVFBFJ1t2YWx1ZUxlbmd0aCAvIDNdO1xuICAgIHJldHVybiBhYmJyVmFsdWUucmVwbGFjZSgnLicsIGRlY2ltYWxTZXBhcmF0b3IpO1xuICB9XG5cbiAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XG59O1xuXG50eXBlIEFiYnJNYXAgPSB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9O1xuXG5jb25zdCBhYmJyTWFwOiBBYmJyTWFwID0geyBrOiAxMDAwLCBtOiAxMDAwMDAwLCBiOiAxMDAwMDAwMDAwIH07XG5cbi8qKlxuICogUGFyc2UgYSB2YWx1ZSB3aXRoIGFiYnJldmlhdGlvbiBlLmcgMWsgPSAxMDAwXG4gKi9cbmV4cG9ydCBjb25zdCBwYXJzZUFiYnJWYWx1ZSA9ICh2YWx1ZTogc3RyaW5nLCBkZWNpbWFsU2VwYXJhdG9yID0gJy4nKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAgY29uc3QgcmVnID0gbmV3IFJlZ0V4cChgKFxcXFxkKygke2VzY2FwZVJlZ0V4cChkZWNpbWFsU2VwYXJhdG9yKX1cXFxcZCopPykoW2ttYl0pJGAsICdpJyk7XG4gIGNvbnN0IG1hdGNoID0gdmFsdWUubWF0Y2gocmVnKTtcblxuICBpZiAobWF0Y2gpIHtcbiAgICBjb25zdCBbLCBkaWdpdHMsICwgYWJicl0gPSBtYXRjaDtcbiAgICBjb25zdCBtdWx0aXBsaWVyID0gYWJick1hcFthYmJyLnRvTG93ZXJDYXNlKCldO1xuXG4gICAgcmV0dXJuIE51bWJlcihkaWdpdHMucmVwbGFjZShkZWNpbWFsU2VwYXJhdG9yLCAnLicpKSAqIG11bHRpcGxpZXI7XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcbiIsImltcG9ydCB7IGVzY2FwZVJlZ0V4cCB9IGZyb20gJy4vZXNjYXBlUmVnRXhwJztcblxuLyoqXG4gKiBSZW1vdmUgZ3JvdXAgc2VwYXJhdG9yIGZyb20gdmFsdWUgZWcuIDEsMDAwID4gMTAwMFxuICovXG5leHBvcnQgY29uc3QgcmVtb3ZlU2VwYXJhdG9ycyA9ICh2YWx1ZTogc3RyaW5nLCBzZXBhcmF0b3IgPSAnLCcpOiBzdHJpbmcgPT4ge1xuICBjb25zdCByZWcgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cChzZXBhcmF0b3IpLCAnZycpO1xuICByZXR1cm4gdmFsdWUucmVwbGFjZShyZWcsICcnKTtcbn07XG4iLCJpbXBvcnQgeyBlc2NhcGVSZWdFeHAgfSBmcm9tICcuL2VzY2FwZVJlZ0V4cCc7XG5cbi8qKlxuICogUmVtb3ZlIGludmFsaWQgY2hhcmFjdGVyc1xuICovXG5leHBvcnQgY29uc3QgcmVtb3ZlSW52YWxpZENoYXJzID0gKHZhbHVlOiBzdHJpbmcsIHZhbGlkQ2hhcnM6IFJlYWRvbmx5QXJyYXk8c3RyaW5nPik6IHN0cmluZyA9PiB7XG4gIGNvbnN0IGNoYXJzID0gZXNjYXBlUmVnRXhwKHZhbGlkQ2hhcnMuam9pbignJykpO1xuICBjb25zdCByZWcgPSBuZXcgUmVnRXhwKGBbXlxcXFxkJHtjaGFyc31dYCwgJ2dpJyk7XG4gIHJldHVybiB2YWx1ZS5yZXBsYWNlKHJlZywgJycpO1xufTtcbiIsImltcG9ydCB7IHBhcnNlQWJiclZhbHVlIH0gZnJvbSAnLi9wYXJzZUFiYnJWYWx1ZSc7XG5pbXBvcnQgeyByZW1vdmVTZXBhcmF0b3JzIH0gZnJvbSAnLi9yZW1vdmVTZXBhcmF0b3JzJztcbmltcG9ydCB7IHJlbW92ZUludmFsaWRDaGFycyB9IGZyb20gJy4vcmVtb3ZlSW52YWxpZENoYXJzJztcbmltcG9ydCB7IGVzY2FwZVJlZ0V4cCB9IGZyb20gJy4vZXNjYXBlUmVnRXhwJztcbmltcG9ydCB7IEN1cnJlbmN5SW5wdXRQcm9wcyB9IGZyb20gJy4uL0N1cnJlbmN5SW5wdXRQcm9wcyc7XG5cbmV4cG9ydCB0eXBlIENsZWFuVmFsdWVPcHRpb25zID0gUGljazxcbiAgQ3VycmVuY3lJbnB1dFByb3BzLFxuICB8ICdkZWNpbWFsU2VwYXJhdG9yJ1xuICB8ICdncm91cFNlcGFyYXRvcidcbiAgfCAnYWxsb3dEZWNpbWFscydcbiAgfCAnZGVjaW1hbHNMaW1pdCdcbiAgfCAnYWxsb3dOZWdhdGl2ZVZhbHVlJ1xuICB8ICdkaXNhYmxlQWJicmV2aWF0aW9ucydcbiAgfCAncHJlZml4J1xuICB8ICd0cmFuc2Zvcm1SYXdWYWx1ZSdcbj4gJiB7IHZhbHVlOiBzdHJpbmcgfTtcblxuLyoqXG4gKiBSZW1vdmUgcHJlZml4LCBzZXBhcmF0b3JzIGFuZCBleHRyYSBkZWNpbWFscyBmcm9tIHZhbHVlXG4gKi9cbmV4cG9ydCBjb25zdCBjbGVhblZhbHVlID0gKHtcbiAgdmFsdWUsXG4gIGdyb3VwU2VwYXJhdG9yID0gJywnLFxuICBkZWNpbWFsU2VwYXJhdG9yID0gJy4nLFxuICBhbGxvd0RlY2ltYWxzID0gdHJ1ZSxcbiAgZGVjaW1hbHNMaW1pdCA9IDIsXG4gIGFsbG93TmVnYXRpdmVWYWx1ZSA9IHRydWUsXG4gIGRpc2FibGVBYmJyZXZpYXRpb25zID0gZmFsc2UsXG4gIHByZWZpeCA9ICcnLFxuICB0cmFuc2Zvcm1SYXdWYWx1ZSA9IChyYXdWYWx1ZSkgPT4gcmF3VmFsdWUsXG59OiBDbGVhblZhbHVlT3B0aW9ucyk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHRyYW5zZm9ybWVkVmFsdWUgPSB0cmFuc2Zvcm1SYXdWYWx1ZSh2YWx1ZSk7XG5cbiAgaWYgKHRyYW5zZm9ybWVkVmFsdWUgPT09ICctJykge1xuICAgIHJldHVybiB0cmFuc2Zvcm1lZFZhbHVlO1xuICB9XG5cbiAgY29uc3QgYWJicmV2aWF0aW9ucyA9IGRpc2FibGVBYmJyZXZpYXRpb25zID8gW10gOiBbJ2snLCAnbScsICdiJ107XG4gIGNvbnN0IHJlZyA9IG5ldyBSZWdFeHAoYCgoXnxcXFxcRCktXFxcXGQpfCgtJHtlc2NhcGVSZWdFeHAocHJlZml4KX0pYCk7XG4gIGNvbnN0IGlzTmVnYXRpdmUgPSByZWcudGVzdCh0cmFuc2Zvcm1lZFZhbHVlKTtcblxuICAvLyBJcyB0aGVyZSBhIGRpZ2l0IGJlZm9yZSB0aGUgcHJlZml4PyBlZy4gMSRcbiAgY29uc3QgW3ByZWZpeFdpdGhWYWx1ZSwgcHJlVmFsdWVdID0gUmVnRXhwKGAoXFxcXGQrKS0/JHtlc2NhcGVSZWdFeHAocHJlZml4KX1gKS5leGVjKHZhbHVlKSB8fCBbXTtcbiAgY29uc3Qgd2l0aG91dFByZWZpeCA9IHByZWZpeFxuICAgID8gcHJlZml4V2l0aFZhbHVlXG4gICAgICA/IHRyYW5zZm9ybWVkVmFsdWUucmVwbGFjZShwcmVmaXhXaXRoVmFsdWUsICcnKS5jb25jYXQocHJlVmFsdWUpXG4gICAgICA6IHRyYW5zZm9ybWVkVmFsdWUucmVwbGFjZShwcmVmaXgsICcnKVxuICAgIDogdHJhbnNmb3JtZWRWYWx1ZTtcbiAgY29uc3Qgd2l0aG91dFNlcGFyYXRvcnMgPSByZW1vdmVTZXBhcmF0b3JzKHdpdGhvdXRQcmVmaXgsIGdyb3VwU2VwYXJhdG9yKTtcbiAgY29uc3Qgd2l0aG91dEludmFsaWRDaGFycyA9IHJlbW92ZUludmFsaWRDaGFycyh3aXRob3V0U2VwYXJhdG9ycywgW1xuICAgIGdyb3VwU2VwYXJhdG9yLFxuICAgIGRlY2ltYWxTZXBhcmF0b3IsXG4gICAgLi4uYWJicmV2aWF0aW9ucyxcbiAgXSk7XG5cbiAgbGV0IHZhbHVlT25seSA9IHdpdGhvdXRJbnZhbGlkQ2hhcnM7XG5cbiAgaWYgKCFkaXNhYmxlQWJicmV2aWF0aW9ucykge1xuICAgIC8vIGRpc2FsbG93IGxldHRlciB3aXRob3V0IG51bWJlclxuICAgIGlmIChcbiAgICAgIGFiYnJldmlhdGlvbnMuc29tZShcbiAgICAgICAgKGxldHRlcikgPT4gbGV0dGVyID09PSB3aXRob3V0SW52YWxpZENoYXJzLnRvTG93ZXJDYXNlKCkucmVwbGFjZShkZWNpbWFsU2VwYXJhdG9yLCAnJylcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VBYmJyVmFsdWUod2l0aG91dEludmFsaWRDaGFycywgZGVjaW1hbFNlcGFyYXRvcik7XG4gICAgaWYgKHBhcnNlZCkge1xuICAgICAgdmFsdWVPbmx5ID0gU3RyaW5nKHBhcnNlZCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgaW5jbHVkZU5lZ2F0aXZlID0gaXNOZWdhdGl2ZSAmJiBhbGxvd05lZ2F0aXZlVmFsdWUgPyAnLScgOiAnJztcblxuICBpZiAoZGVjaW1hbFNlcGFyYXRvciAmJiB2YWx1ZU9ubHkuaW5jbHVkZXMoZGVjaW1hbFNlcGFyYXRvcikpIHtcbiAgICBjb25zdCBbaW50LCBkZWNpbWFsc10gPSB3aXRob3V0SW52YWxpZENoYXJzLnNwbGl0KGRlY2ltYWxTZXBhcmF0b3IpO1xuICAgIGNvbnN0IHRyaW1tZWREZWNpbWFscyA9IGRlY2ltYWxzTGltaXQgJiYgZGVjaW1hbHMgPyBkZWNpbWFscy5zbGljZSgwLCBkZWNpbWFsc0xpbWl0KSA6IGRlY2ltYWxzO1xuICAgIGNvbnN0IGluY2x1ZGVEZWNpbWFscyA9IGFsbG93RGVjaW1hbHMgPyBgJHtkZWNpbWFsU2VwYXJhdG9yfSR7dHJpbW1lZERlY2ltYWxzfWAgOiAnJztcblxuICAgIHJldHVybiBgJHtpbmNsdWRlTmVnYXRpdmV9JHtpbnR9JHtpbmNsdWRlRGVjaW1hbHN9YDtcbiAgfVxuXG4gIHJldHVybiBgJHtpbmNsdWRlTmVnYXRpdmV9JHt2YWx1ZU9ubHl9YDtcbn07XG4iLCJleHBvcnQgY29uc3QgZml4ZWREZWNpbWFsVmFsdWUgPSAoXG4gIHZhbHVlOiBzdHJpbmcsXG4gIGRlY2ltYWxTZXBhcmF0b3I6IHN0cmluZyxcbiAgZml4ZWREZWNpbWFsTGVuZ3RoPzogbnVtYmVyXG4pOiBzdHJpbmcgPT4ge1xuICBpZiAoZml4ZWREZWNpbWFsTGVuZ3RoICE9PSB1bmRlZmluZWQgJiYgdmFsdWUubGVuZ3RoID4gMSkge1xuICAgIGlmIChmaXhlZERlY2ltYWxMZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKGRlY2ltYWxTZXBhcmF0b3IsICcnKTtcbiAgICB9XG5cbiAgICBpZiAodmFsdWUuaW5jbHVkZXMoZGVjaW1hbFNlcGFyYXRvcikpIHtcbiAgICAgIGNvbnN0IFtpbnQsIGRlY2ltYWxzXSA9IHZhbHVlLnNwbGl0KGRlY2ltYWxTZXBhcmF0b3IpO1xuXG4gICAgICBpZiAoZGVjaW1hbHMubGVuZ3RoID09PSBmaXhlZERlY2ltYWxMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGVjaW1hbHMubGVuZ3RoID4gZml4ZWREZWNpbWFsTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBgJHtpbnR9JHtkZWNpbWFsU2VwYXJhdG9yfSR7ZGVjaW1hbHMuc2xpY2UoMCwgZml4ZWREZWNpbWFsTGVuZ3RoKX1gO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlZyA9XG4gICAgICB2YWx1ZS5sZW5ndGggPiBmaXhlZERlY2ltYWxMZW5ndGhcbiAgICAgICAgPyBuZXcgUmVnRXhwKGAoXFxcXGQrKShcXFxcZHske2ZpeGVkRGVjaW1hbExlbmd0aH19KWApXG4gICAgICAgIDogbmV3IFJlZ0V4cChgKFxcXFxkKShcXFxcZCspYCk7XG5cbiAgICBjb25zdCBtYXRjaCA9IHZhbHVlLm1hdGNoKHJlZyk7XG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICBjb25zdCBbLCBpbnQsIGRlY2ltYWxzXSA9IG1hdGNoO1xuICAgICAgcmV0dXJuIGAke2ludH0ke2RlY2ltYWxTZXBhcmF0b3J9JHtkZWNpbWFsc31gO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB2YWx1ZTtcbn07XG4iLCJpbXBvcnQgeyBlc2NhcGVSZWdFeHAgfSBmcm9tICcuL2VzY2FwZVJlZ0V4cCc7XG50eXBlIE9wdGlvbnMgPSB7XG4gIGRlY2ltYWxTZXBhcmF0b3I/OiBzdHJpbmc7XG4gIGdyb3VwU2VwYXJhdG9yPzogc3RyaW5nO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFN1ZmZpeCA9IChcbiAgdmFsdWU6IHN0cmluZyxcbiAgeyBncm91cFNlcGFyYXRvciA9ICcsJywgZGVjaW1hbFNlcGFyYXRvciA9ICcuJyB9OiBPcHRpb25zXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCBzdWZmaXhSZWcgPSBuZXcgUmVnRXhwKFxuICAgIGBcXFxcZChbXiR7ZXNjYXBlUmVnRXhwKGdyb3VwU2VwYXJhdG9yKX0ke2VzY2FwZVJlZ0V4cChkZWNpbWFsU2VwYXJhdG9yKX0wLTldKylgXG4gICk7XG4gIGNvbnN0IHN1ZmZpeE1hdGNoID0gdmFsdWUubWF0Y2goc3VmZml4UmVnKTtcbiAgcmV0dXJuIHN1ZmZpeE1hdGNoID8gc3VmZml4TWF0Y2hbMV0gOiB1bmRlZmluZWQ7XG59O1xuIiwiaW1wb3J0IHsgSW50bENvbmZpZyB9IGZyb20gJy4uL0N1cnJlbmN5SW5wdXRQcm9wcyc7XG5pbXBvcnQgeyBlc2NhcGVSZWdFeHAgfSBmcm9tICcuL2VzY2FwZVJlZ0V4cCc7XG5pbXBvcnQgeyBnZXRTdWZmaXggfSBmcm9tICcuL2dldFN1ZmZpeCc7XG5cbmV4cG9ydCB0eXBlIEZvcm1hdFZhbHVlT3B0aW9ucyA9IHtcbiAgLyoqXG4gICAqIFZhbHVlIHRvIGZvcm1hdFxuICAgKi9cbiAgdmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogRGVjaW1hbCBzZXBhcmF0b3JcbiAgICpcbiAgICogRGVmYXVsdCA9ICcuJ1xuICAgKi9cbiAgZGVjaW1hbFNlcGFyYXRvcj86IHN0cmluZztcblxuICAvKipcbiAgICogR3JvdXAgc2VwYXJhdG9yXG4gICAqXG4gICAqIERlZmF1bHQgPSAnLCdcbiAgICovXG4gIGdyb3VwU2VwYXJhdG9yPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUdXJuIG9mZiBzZXBhcmF0b3JzXG4gICAqXG4gICAqIFRoaXMgd2lsbCBvdmVycmlkZSBHcm91cCBzZXBhcmF0b3JzXG4gICAqXG4gICAqIERlZmF1bHQgPSBmYWxzZVxuICAgKi9cbiAgZGlzYWJsZUdyb3VwU2VwYXJhdG9ycz86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEludGwgbG9jYWxlIGN1cnJlbmN5IGNvbmZpZ1xuICAgKi9cbiAgaW50bENvbmZpZz86IEludGxDb25maWc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgZGVjaW1hbCBzY2FsZSBmb3IgcGFkZGluZy90cmltbWluZ1xuICAgKlxuICAgKiBFZy4gMS41IC0+IDEuNTAgb3IgMS4yMzQgLT4gMS4yM1xuICAgKi9cbiAgZGVjaW1hbFNjYWxlPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBQcmVmaXhcbiAgICovXG4gIHByZWZpeD86IHN0cmluZztcblxuICAvKipcbiAgICogU3VmZml4XG4gICAqL1xuICBzdWZmaXg/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIEZvcm1hdCB2YWx1ZSB3aXRoIGRlY2ltYWwgc2VwYXJhdG9yLCBncm91cCBzZXBhcmF0b3IgYW5kIHByZWZpeFxuICovXG5leHBvcnQgY29uc3QgZm9ybWF0VmFsdWUgPSAob3B0aW9uczogRm9ybWF0VmFsdWVPcHRpb25zKTogc3RyaW5nID0+IHtcbiAgY29uc3Qge1xuICAgIHZhbHVlOiBfdmFsdWUsXG4gICAgZGVjaW1hbFNlcGFyYXRvcixcbiAgICBpbnRsQ29uZmlnLFxuICAgIGRlY2ltYWxTY2FsZSxcbiAgICBwcmVmaXggPSAnJyxcbiAgICBzdWZmaXggPSAnJyxcbiAgfSA9IG9wdGlvbnM7XG5cbiAgaWYgKF92YWx1ZSA9PT0gJycgfHwgX3ZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAoX3ZhbHVlID09PSAnLScpIHtcbiAgICByZXR1cm4gJy0nO1xuICB9XG5cbiAgY29uc3QgaXNOZWdhdGl2ZSA9IG5ldyBSZWdFeHAoYF5cXFxcZD8tJHtwcmVmaXggPyBgJHtlc2NhcGVSZWdFeHAocHJlZml4KX0/YCA6ICcnfVxcXFxkYCkudGVzdChcbiAgICBfdmFsdWVcbiAgKTtcblxuICBsZXQgdmFsdWUgPVxuICAgIGRlY2ltYWxTZXBhcmF0b3IgIT09ICcuJ1xuICAgICAgPyByZXBsYWNlRGVjaW1hbFNlcGFyYXRvcihfdmFsdWUsIGRlY2ltYWxTZXBhcmF0b3IsIGlzTmVnYXRpdmUpXG4gICAgICA6IF92YWx1ZTtcblxuICBpZiAoZGVjaW1hbFNlcGFyYXRvciAmJiBkZWNpbWFsU2VwYXJhdG9yICE9PSAnLScgJiYgdmFsdWUuc3RhcnRzV2l0aChkZWNpbWFsU2VwYXJhdG9yKSkge1xuICAgIHZhbHVlID0gJzAnICsgdmFsdWU7XG4gIH1cblxuICBjb25zdCBkZWZhdWx0TnVtYmVyRm9ybWF0T3B0aW9ucyA9IHtcbiAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IGRlY2ltYWxTY2FsZSB8fCAwLFxuICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMjAsXG4gIH07XG5cbiAgY29uc3QgbnVtYmVyRm9ybWF0dGVyID0gaW50bENvbmZpZ1xuICAgID8gbmV3IEludGwuTnVtYmVyRm9ybWF0KFxuICAgICAgICBpbnRsQ29uZmlnLmxvY2FsZSxcbiAgICAgICAgaW50bENvbmZpZy5jdXJyZW5jeVxuICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAuLi5kZWZhdWx0TnVtYmVyRm9ybWF0T3B0aW9ucyxcbiAgICAgICAgICAgICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgICAgICAgICAgIGN1cnJlbmN5OiBpbnRsQ29uZmlnLmN1cnJlbmN5LFxuICAgICAgICAgICAgfVxuICAgICAgICAgIDogZGVmYXVsdE51bWJlckZvcm1hdE9wdGlvbnNcbiAgICAgIClcbiAgICA6IG5ldyBJbnRsLk51bWJlckZvcm1hdCh1bmRlZmluZWQsIGRlZmF1bHROdW1iZXJGb3JtYXRPcHRpb25zKTtcblxuICBjb25zdCBwYXJ0cyA9IG51bWJlckZvcm1hdHRlci5mb3JtYXRUb1BhcnRzKE51bWJlcih2YWx1ZSkpO1xuXG4gIGxldCBmb3JtYXR0ZWQgPSByZXBsYWNlUGFydHMocGFydHMsIG9wdGlvbnMpO1xuXG4gIC8vIERvZXMgaW50bCBmb3JtYXR0aW5nIGFkZCBhIHN1ZmZpeD9cbiAgY29uc3QgaW50bFN1ZmZpeCA9IGdldFN1ZmZpeChmb3JtYXR0ZWQsIHsgLi4ub3B0aW9ucyB9KTtcblxuICAvLyBJbmNsdWRlIGRlY2ltYWwgc2VwYXJhdG9yIGlmIHVzZXIgaW5wdXQgZW5kcyB3aXRoIGRlY2ltYWwgc2VwYXJhdG9yXG4gIGNvbnN0IGluY2x1ZGVEZWNpbWFsU2VwYXJhdG9yID0gX3ZhbHVlLnNsaWNlKC0xKSA9PT0gZGVjaW1hbFNlcGFyYXRvciA/IGRlY2ltYWxTZXBhcmF0b3IgOiAnJztcblxuICBjb25zdCBbLCBkZWNpbWFsc10gPSB2YWx1ZS5tYXRjaChSZWdFeHAoJ1xcXFxkK1xcXFwuKFxcXFxkKyknKSkgfHwgW107XG5cbiAgLy8gS2VlcCBvcmlnaW5hbCBkZWNpbWFsIHBhZGRpbmcgaWYgbm8gZGVjaW1hbFNjYWxlXG4gIGlmIChkZWNpbWFsU2NhbGUgPT09IHVuZGVmaW5lZCAmJiBkZWNpbWFscyAmJiBkZWNpbWFsU2VwYXJhdG9yKSB7XG4gICAgaWYgKGZvcm1hdHRlZC5pbmNsdWRlcyhkZWNpbWFsU2VwYXJhdG9yKSkge1xuICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoXG4gICAgICAgIFJlZ0V4cChgKFxcXFxkKykoJHtlc2NhcGVSZWdFeHAoZGVjaW1hbFNlcGFyYXRvcil9KShcXFxcZCspYCwgJ2cnKSxcbiAgICAgICAgYCQxJDIke2RlY2ltYWxzfWBcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpbnRsU3VmZml4ICYmICFzdWZmaXgpIHtcbiAgICAgICAgZm9ybWF0dGVkID0gZm9ybWF0dGVkLnJlcGxhY2UoaW50bFN1ZmZpeCwgYCR7ZGVjaW1hbFNlcGFyYXRvcn0ke2RlY2ltYWxzfSR7aW50bFN1ZmZpeH1gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdHRlZCA9IGAke2Zvcm1hdHRlZH0ke2RlY2ltYWxTZXBhcmF0b3J9JHtkZWNpbWFsc31gO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdWZmaXggJiYgaW5jbHVkZURlY2ltYWxTZXBhcmF0b3IpIHtcbiAgICByZXR1cm4gYCR7Zm9ybWF0dGVkfSR7aW5jbHVkZURlY2ltYWxTZXBhcmF0b3J9JHtzdWZmaXh9YDtcbiAgfVxuXG4gIGlmIChpbnRsU3VmZml4ICYmIGluY2x1ZGVEZWNpbWFsU2VwYXJhdG9yKSB7XG4gICAgcmV0dXJuIGZvcm1hdHRlZC5yZXBsYWNlKGludGxTdWZmaXgsIGAke2luY2x1ZGVEZWNpbWFsU2VwYXJhdG9yfSR7aW50bFN1ZmZpeH1gKTtcbiAgfVxuXG4gIGlmIChpbnRsU3VmZml4ICYmIHN1ZmZpeCkge1xuICAgIHJldHVybiBmb3JtYXR0ZWQucmVwbGFjZShpbnRsU3VmZml4LCBgJHtpbmNsdWRlRGVjaW1hbFNlcGFyYXRvcn0ke3N1ZmZpeH1gKTtcbiAgfVxuXG4gIHJldHVybiBbZm9ybWF0dGVkLCBpbmNsdWRlRGVjaW1hbFNlcGFyYXRvciwgc3VmZml4XS5qb2luKCcnKTtcbn07XG5cbi8qKlxuICogQmVmb3JlIGNvbnZlcnRpbmcgdG8gTnVtYmVyLCBkZWNpbWFsIHNlcGFyYXRvciBoYXMgdG8gYmUgLlxuICovXG5jb25zdCByZXBsYWNlRGVjaW1hbFNlcGFyYXRvciA9IChcbiAgdmFsdWU6IHN0cmluZyxcbiAgZGVjaW1hbFNlcGFyYXRvcjogRm9ybWF0VmFsdWVPcHRpb25zWydkZWNpbWFsU2VwYXJhdG9yJ10sXG4gIGlzTmVnYXRpdmU6IGJvb2xlYW5cbik6IHN0cmluZyA9PiB7XG4gIGxldCBuZXdWYWx1ZSA9IHZhbHVlO1xuICBpZiAoZGVjaW1hbFNlcGFyYXRvciAmJiBkZWNpbWFsU2VwYXJhdG9yICE9PSAnLicpIHtcbiAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlLnJlcGxhY2UoUmVnRXhwKGVzY2FwZVJlZ0V4cChkZWNpbWFsU2VwYXJhdG9yKSwgJ2cnKSwgJy4nKTtcbiAgICBpZiAoaXNOZWdhdGl2ZSAmJiBkZWNpbWFsU2VwYXJhdG9yID09PSAnLScpIHtcbiAgICAgIG5ld1ZhbHVlID0gYC0ke25ld1ZhbHVlLnNsaWNlKDEpfWA7XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdWYWx1ZTtcbn07XG5cbmNvbnN0IHJlcGxhY2VQYXJ0cyA9IChcbiAgcGFydHM6IEludGwuTnVtYmVyRm9ybWF0UGFydFtdLFxuICB7XG4gICAgcHJlZml4LFxuICAgIGdyb3VwU2VwYXJhdG9yLFxuICAgIGRlY2ltYWxTZXBhcmF0b3IsXG4gICAgZGVjaW1hbFNjYWxlLFxuICAgIGRpc2FibGVHcm91cFNlcGFyYXRvcnMgPSBmYWxzZSxcbiAgfTogUGljazxcbiAgICBGb3JtYXRWYWx1ZU9wdGlvbnMsXG4gICAgJ3ByZWZpeCcgfCAnZ3JvdXBTZXBhcmF0b3InIHwgJ2RlY2ltYWxTZXBhcmF0b3InIHwgJ2RlY2ltYWxTY2FsZScgfCAnZGlzYWJsZUdyb3VwU2VwYXJhdG9ycydcbiAgPlxuKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIHBhcnRzXG4gICAgLnJlZHVjZShcbiAgICAgIChwcmV2LCB7IHR5cGUsIHZhbHVlIH0sIGkpID0+IHtcbiAgICAgICAgaWYgKGkgPT09IDAgJiYgcHJlZml4KSB7XG4gICAgICAgICAgaWYgKHR5cGUgPT09ICdtaW51c1NpZ24nKSB7XG4gICAgICAgICAgICByZXR1cm4gW3ZhbHVlLCBwcmVmaXhdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0eXBlID09PSAnY3VycmVuY3knKSB7XG4gICAgICAgICAgICByZXR1cm4gWy4uLnByZXYsIHByZWZpeF07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIFtwcmVmaXgsIHZhbHVlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlID09PSAnY3VycmVuY3knKSB7XG4gICAgICAgICAgcmV0dXJuIHByZWZpeCA/IHByZXYgOiBbLi4ucHJldiwgdmFsdWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgPT09ICdncm91cCcpIHtcbiAgICAgICAgICByZXR1cm4gIWRpc2FibGVHcm91cFNlcGFyYXRvcnNcbiAgICAgICAgICAgID8gWy4uLnByZXYsIGdyb3VwU2VwYXJhdG9yICE9PSB1bmRlZmluZWQgPyBncm91cFNlcGFyYXRvciA6IHZhbHVlXVxuICAgICAgICAgICAgOiBwcmV2O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGUgPT09ICdkZWNpbWFsJykge1xuICAgICAgICAgIGlmIChkZWNpbWFsU2NhbGUgIT09IHVuZGVmaW5lZCAmJiBkZWNpbWFsU2NhbGUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBwcmV2O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBbLi4ucHJldiwgZGVjaW1hbFNlcGFyYXRvciAhPT0gdW5kZWZpbmVkID8gZGVjaW1hbFNlcGFyYXRvciA6IHZhbHVlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlID09PSAnZnJhY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIFsuLi5wcmV2LCBkZWNpbWFsU2NhbGUgIT09IHVuZGVmaW5lZCA/IHZhbHVlLnNsaWNlKDAsIGRlY2ltYWxTY2FsZSkgOiB2YWx1ZV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gWy4uLnByZXYsIHZhbHVlXTtcbiAgICAgIH0sXG4gICAgICBbJyddXG4gICAgKVxuICAgIC5qb2luKCcnKTtcbn07XG4iLCJpbXBvcnQgeyBJbnRsQ29uZmlnIH0gZnJvbSAnLi4vQ3VycmVuY3lJbnB1dFByb3BzJztcblxudHlwZSBMb2NhbGVDb25maWcgPSB7XG4gIGN1cnJlbmN5U3ltYm9sOiBzdHJpbmc7XG4gIGdyb3VwU2VwYXJhdG9yOiBzdHJpbmc7XG4gIGRlY2ltYWxTZXBhcmF0b3I6IHN0cmluZztcbiAgcHJlZml4OiBzdHJpbmc7XG4gIHN1ZmZpeDogc3RyaW5nO1xufTtcblxuY29uc3QgZGVmYXVsdENvbmZpZzogTG9jYWxlQ29uZmlnID0ge1xuICBjdXJyZW5jeVN5bWJvbDogJycsXG4gIGdyb3VwU2VwYXJhdG9yOiAnJyxcbiAgZGVjaW1hbFNlcGFyYXRvcjogJycsXG4gIHByZWZpeDogJycsXG4gIHN1ZmZpeDogJycsXG59O1xuXG4vKipcbiAqIEdldCBsb2NhbGUgY29uZmlnIGZyb20gaW5wdXQgb3IgZGVmYXVsdFxuICovXG5leHBvcnQgY29uc3QgZ2V0TG9jYWxlQ29uZmlnID0gKGludGxDb25maWc/OiBJbnRsQ29uZmlnKTogTG9jYWxlQ29uZmlnID0+IHtcbiAgY29uc3QgeyBsb2NhbGUsIGN1cnJlbmN5IH0gPSBpbnRsQ29uZmlnIHx8IHt9O1xuICBjb25zdCBudW1iZXJGb3JtYXR0ZXIgPSBsb2NhbGVcbiAgICA/IG5ldyBJbnRsLk51bWJlckZvcm1hdChsb2NhbGUsIGN1cnJlbmN5ID8geyBjdXJyZW5jeSwgc3R5bGU6ICdjdXJyZW5jeScgfSA6IHVuZGVmaW5lZClcbiAgICA6IG5ldyBJbnRsLk51bWJlckZvcm1hdCgpO1xuXG4gIHJldHVybiBudW1iZXJGb3JtYXR0ZXIuZm9ybWF0VG9QYXJ0cygxMDAwLjEpLnJlZHVjZSgocHJldiwgY3VyciwgaSk6IExvY2FsZUNvbmZpZyA9PiB7XG4gICAgaWYgKGN1cnIudHlwZSA9PT0gJ2N1cnJlbmN5Jykge1xuICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHsgLi4ucHJldiwgY3VycmVuY3lTeW1ib2w6IGN1cnIudmFsdWUsIHByZWZpeDogY3Vyci52YWx1ZSB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgLi4ucHJldiwgY3VycmVuY3lTeW1ib2w6IGN1cnIudmFsdWUsIHN1ZmZpeDogY3Vyci52YWx1ZSB9O1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3Vyci50eXBlID09PSAnZ3JvdXAnKSB7XG4gICAgICByZXR1cm4geyAuLi5wcmV2LCBncm91cFNlcGFyYXRvcjogY3Vyci52YWx1ZSB9O1xuICAgIH1cbiAgICBpZiAoY3Vyci50eXBlID09PSAnZGVjaW1hbCcpIHtcbiAgICAgIHJldHVybiB7IC4uLnByZXYsIGRlY2ltYWxTZXBhcmF0b3I6IGN1cnIudmFsdWUgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJldjtcbiAgfSwgZGVmYXVsdENvbmZpZyk7XG59O1xuIiwiZXhwb3J0IGNvbnN0IGlzTnVtYmVyID0gKGlucHV0OiBzdHJpbmcpOiBib29sZWFuID0+IFJlZ0V4cCgvXFxkLywgJ2dpJykudGVzdChpbnB1dCk7XG4iLCJleHBvcnQgY29uc3QgcGFkVHJpbVZhbHVlID0gKFxuICB2YWx1ZTogc3RyaW5nLFxuICBkZWNpbWFsU2VwYXJhdG9yID0gJy4nLFxuICBkZWNpbWFsU2NhbGU/OiBudW1iZXJcbik6IHN0cmluZyA9PiB7XG4gIGlmIChkZWNpbWFsU2NhbGUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gJycgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGlmICghdmFsdWUubWF0Y2goL1xcZC9nKSkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGNvbnN0IFtpbnQsIGRlY2ltYWxzXSA9IHZhbHVlLnNwbGl0KGRlY2ltYWxTZXBhcmF0b3IpO1xuXG4gIGlmIChkZWNpbWFsU2NhbGUgPT09IDApIHtcbiAgICByZXR1cm4gaW50O1xuICB9XG5cbiAgbGV0IG5ld1ZhbHVlID0gZGVjaW1hbHMgfHwgJyc7XG5cbiAgaWYgKG5ld1ZhbHVlLmxlbmd0aCA8IGRlY2ltYWxTY2FsZSkge1xuICAgIHdoaWxlIChuZXdWYWx1ZS5sZW5ndGggPCBkZWNpbWFsU2NhbGUpIHtcbiAgICAgIG5ld1ZhbHVlICs9ICcwJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbmV3VmFsdWUgPSBuZXdWYWx1ZS5zbGljZSgwLCBkZWNpbWFsU2NhbGUpO1xuICB9XG5cbiAgcmV0dXJuIGAke2ludH0ke2RlY2ltYWxTZXBhcmF0b3J9JHtuZXdWYWx1ZX1gO1xufTtcbiIsInR5cGUgUmVwb3NpdGlvbkN1cnNvclByb3BzID0ge1xuICBzZWxlY3Rpb25TdGFydD86IG51bWJlciB8IG51bGw7XG4gIHZhbHVlOiBzdHJpbmc7XG4gIGxhc3RLZXlTdHJva2U6IHN0cmluZyB8IG51bGw7XG4gIHN0YXRlVmFsdWU/OiBzdHJpbmc7XG4gIGdyb3VwU2VwYXJhdG9yPzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBCYXNlZCBvbiB0aGUgbGFzdCBrZXkgc3Ryb2tlIGFuZCB0aGUgY3Vyc29yIHBvc2l0aW9uLCB1cGRhdGUgdGhlIHZhbHVlXG4gKiBhbmQgcmVwb3NpdGlvbiB0aGUgY3Vyc29yIHRvIHRoZSByaWdodCBwbGFjZVxuICovXG5leHBvcnQgY29uc3QgcmVwb3NpdGlvbkN1cnNvciA9ICh7XG4gIHNlbGVjdGlvblN0YXJ0LFxuICB2YWx1ZSxcbiAgbGFzdEtleVN0cm9rZSxcbiAgc3RhdGVWYWx1ZSxcbiAgZ3JvdXBTZXBhcmF0b3IsXG59OiBSZXBvc2l0aW9uQ3Vyc29yUHJvcHMpOiB7XG4gIG1vZGlmaWVkVmFsdWU6IHN0cmluZztcbiAgY3Vyc29yUG9zaXRpb246IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQ7XG59ID0+IHtcbiAgbGV0IGN1cnNvclBvc2l0aW9uID0gc2VsZWN0aW9uU3RhcnQ7XG4gIGxldCBtb2RpZmllZFZhbHVlID0gdmFsdWU7XG4gIGlmIChzdGF0ZVZhbHVlICYmIGN1cnNvclBvc2l0aW9uKSB7XG4gICAgY29uc3Qgc3BsaXRWYWx1ZSA9IHZhbHVlLnNwbGl0KCcnKTtcbiAgICAvLyBpZiBjdXJzb3IgaXMgdG8gcmlnaHQgb2YgZ3JvdXBTZXBhcmF0b3IgYW5kIGJhY2tzcGFjZSBwcmVzc2VkLCBkZWxldGUgdGhlIGNoYXJhY3RlciB0byB0aGUgbGVmdCBvZiB0aGUgc2VwYXJhdG9yIGFuZCByZXBvc2l0aW9uIHRoZSBjdXJzb3JcbiAgICBpZiAobGFzdEtleVN0cm9rZSA9PT0gJ0JhY2tzcGFjZScgJiYgc3RhdGVWYWx1ZVtjdXJzb3JQb3NpdGlvbl0gPT09IGdyb3VwU2VwYXJhdG9yKSB7XG4gICAgICBzcGxpdFZhbHVlLnNwbGljZShjdXJzb3JQb3NpdGlvbiAtIDEsIDEpO1xuICAgICAgY3Vyc29yUG9zaXRpb24gLT0gMTtcbiAgICB9XG4gICAgLy8gaWYgY3Vyc29yIGlzIHRvIGxlZnQgb2YgZ3JvdXBTZXBhcmF0b3IgYW5kIGRlbGV0ZSBwcmVzc2VkLCBkZWxldGUgdGhlIGNoYXJhY3RlciB0byB0aGUgcmlnaHQgb2YgdGhlIHNlcGFyYXRvciBhbmQgcmVwb3NpdGlvbiB0aGUgY3Vyc29yXG4gICAgaWYgKGxhc3RLZXlTdHJva2UgPT09ICdEZWxldGUnICYmIHN0YXRlVmFsdWVbY3Vyc29yUG9zaXRpb25dID09PSBncm91cFNlcGFyYXRvcikge1xuICAgICAgc3BsaXRWYWx1ZS5zcGxpY2UoY3Vyc29yUG9zaXRpb24sIDEpO1xuICAgICAgY3Vyc29yUG9zaXRpb24gKz0gMTtcbiAgICB9XG4gICAgbW9kaWZpZWRWYWx1ZSA9IHNwbGl0VmFsdWUuam9pbignJyk7XG4gICAgcmV0dXJuIHsgbW9kaWZpZWRWYWx1ZSwgY3Vyc29yUG9zaXRpb24gfTtcbiAgfVxuXG4gIHJldHVybiB7IG1vZGlmaWVkVmFsdWUsIGN1cnNvclBvc2l0aW9uOiBzZWxlY3Rpb25TdGFydCB9O1xufTtcbiIsImltcG9ydCBSZWFjdCwge1xuICBGQyxcbiAgdXNlU3RhdGUsXG4gIHVzZUVmZmVjdCxcbiAgdXNlUmVmLFxuICBmb3J3YXJkUmVmLFxuICB1c2VNZW1vLFxuICB1c2VJbXBlcmF0aXZlSGFuZGxlLFxufSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDdXJyZW5jeUlucHV0UHJvcHMsIEN1cnJlbmN5SW5wdXRPbkNoYW5nZVZhbHVlcyB9IGZyb20gJy4vQ3VycmVuY3lJbnB1dFByb3BzJztcbmltcG9ydCB7XG4gIGlzTnVtYmVyLFxuICBjbGVhblZhbHVlLFxuICBmaXhlZERlY2ltYWxWYWx1ZSxcbiAgZm9ybWF0VmFsdWUsXG4gIGdldExvY2FsZUNvbmZpZyxcbiAgcGFkVHJpbVZhbHVlLFxuICBDbGVhblZhbHVlT3B0aW9ucyxcbiAgZ2V0U3VmZml4LFxuICBGb3JtYXRWYWx1ZU9wdGlvbnMsXG4gIHJlcG9zaXRpb25DdXJzb3IsXG59IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY29uc3QgQ3VycmVuY3lJbnB1dDogRkM8Q3VycmVuY3lJbnB1dFByb3BzPiA9IGZvcndhcmRSZWY8XG4gIEhUTUxJbnB1dEVsZW1lbnQsXG4gIEN1cnJlbmN5SW5wdXRQcm9wc1xuPihcbiAgKFxuICAgIHtcbiAgICAgIGFsbG93RGVjaW1hbHMgPSB0cnVlLFxuICAgICAgYWxsb3dOZWdhdGl2ZVZhbHVlID0gdHJ1ZSxcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIGN1c3RvbUlucHV0LFxuICAgICAgZGVjaW1hbHNMaW1pdCxcbiAgICAgIGRlZmF1bHRWYWx1ZSxcbiAgICAgIGRpc2FibGVkID0gZmFsc2UsXG4gICAgICBtYXhMZW5ndGg6IHVzZXJNYXhMZW5ndGgsXG4gICAgICB2YWx1ZTogdXNlclZhbHVlLFxuICAgICAgb25WYWx1ZUNoYW5nZSxcbiAgICAgIGZpeGVkRGVjaW1hbExlbmd0aCxcbiAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgZGVjaW1hbFNjYWxlLFxuICAgICAgcHJlZml4LFxuICAgICAgc3VmZml4LFxuICAgICAgaW50bENvbmZpZyxcbiAgICAgIHN0ZXAsXG4gICAgICBtaW4sXG4gICAgICBtYXgsXG4gICAgICBkaXNhYmxlR3JvdXBTZXBhcmF0b3JzID0gZmFsc2UsXG4gICAgICBkaXNhYmxlQWJicmV2aWF0aW9ucyA9IGZhbHNlLFxuICAgICAgZGVjaW1hbFNlcGFyYXRvcjogX2RlY2ltYWxTZXBhcmF0b3IsXG4gICAgICBncm91cFNlcGFyYXRvcjogX2dyb3VwU2VwYXJhdG9yLFxuICAgICAgb25DaGFuZ2UsXG4gICAgICBvbkZvY3VzLFxuICAgICAgb25CbHVyLFxuICAgICAgb25LZXlEb3duLFxuICAgICAgb25LZXlVcCxcbiAgICAgIHRyYW5zZm9ybVJhd1ZhbHVlLFxuICAgICAgZm9ybWF0VmFsdWVPbkJsdXIgPSB0cnVlLFxuICAgICAgLi4ucHJvcHNcbiAgICB9OiBDdXJyZW5jeUlucHV0UHJvcHMsXG4gICAgcmVmXG4gICkgPT4ge1xuICAgIGlmIChfZGVjaW1hbFNlcGFyYXRvciAmJiBpc051bWJlcihfZGVjaW1hbFNlcGFyYXRvcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignZGVjaW1hbFNlcGFyYXRvciBjYW5ub3QgYmUgYSBudW1iZXInKTtcbiAgICB9XG5cbiAgICBpZiAoX2dyb3VwU2VwYXJhdG9yICYmIGlzTnVtYmVyKF9ncm91cFNlcGFyYXRvcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignZ3JvdXBTZXBhcmF0b3IgY2Fubm90IGJlIGEgbnVtYmVyJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYWxlQ29uZmlnID0gdXNlTWVtbygoKSA9PiBnZXRMb2NhbGVDb25maWcoaW50bENvbmZpZyksIFtpbnRsQ29uZmlnXSk7XG4gICAgY29uc3QgZGVjaW1hbFNlcGFyYXRvciA9IF9kZWNpbWFsU2VwYXJhdG9yIHx8IGxvY2FsZUNvbmZpZy5kZWNpbWFsU2VwYXJhdG9yIHx8ICcnO1xuICAgIGNvbnN0IGdyb3VwU2VwYXJhdG9yID0gX2dyb3VwU2VwYXJhdG9yIHx8IGxvY2FsZUNvbmZpZy5ncm91cFNlcGFyYXRvciB8fCAnJztcblxuICAgIGlmIChcbiAgICAgIGRlY2ltYWxTZXBhcmF0b3IgJiZcbiAgICAgIGdyb3VwU2VwYXJhdG9yICYmXG4gICAgICBkZWNpbWFsU2VwYXJhdG9yID09PSBncm91cFNlcGFyYXRvciAmJlxuICAgICAgZGlzYWJsZUdyb3VwU2VwYXJhdG9ycyA9PT0gZmFsc2VcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignZGVjaW1hbFNlcGFyYXRvciBjYW5ub3QgYmUgdGhlIHNhbWUgYXMgZ3JvdXBTZXBhcmF0b3InKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRWYWx1ZU9wdGlvbnM6IFBhcnRpYWw8Rm9ybWF0VmFsdWVPcHRpb25zPiA9IHtcbiAgICAgIGRlY2ltYWxTZXBhcmF0b3IsXG4gICAgICBncm91cFNlcGFyYXRvcixcbiAgICAgIGRpc2FibGVHcm91cFNlcGFyYXRvcnMsXG4gICAgICBpbnRsQ29uZmlnLFxuICAgICAgcHJlZml4OiBwcmVmaXggfHwgbG9jYWxlQ29uZmlnLnByZWZpeCxcbiAgICAgIHN1ZmZpeDogc3VmZml4LFxuICAgIH07XG5cbiAgICBjb25zdCBjbGVhblZhbHVlT3B0aW9uczogUGFydGlhbDxDbGVhblZhbHVlT3B0aW9ucz4gPSB7XG4gICAgICBkZWNpbWFsU2VwYXJhdG9yLFxuICAgICAgZ3JvdXBTZXBhcmF0b3IsXG4gICAgICBhbGxvd0RlY2ltYWxzLFxuICAgICAgZGVjaW1hbHNMaW1pdDogZGVjaW1hbHNMaW1pdCB8fCBmaXhlZERlY2ltYWxMZW5ndGggfHwgMixcbiAgICAgIGFsbG93TmVnYXRpdmVWYWx1ZSxcbiAgICAgIGRpc2FibGVBYmJyZXZpYXRpb25zLFxuICAgICAgcHJlZml4OiBwcmVmaXggfHwgbG9jYWxlQ29uZmlnLnByZWZpeCxcbiAgICAgIHRyYW5zZm9ybVJhd1ZhbHVlLFxuICAgIH07XG5cbiAgICBjb25zdCBbc3RhdGVWYWx1ZSwgc2V0U3RhdGVWYWx1ZV0gPSB1c2VTdGF0ZSgoKSA9PlxuICAgICAgZGVmYXVsdFZhbHVlICE9IG51bGxcbiAgICAgICAgPyBmb3JtYXRWYWx1ZSh7IC4uLmZvcm1hdFZhbHVlT3B0aW9ucywgZGVjaW1hbFNjYWxlLCB2YWx1ZTogU3RyaW5nKGRlZmF1bHRWYWx1ZSkgfSlcbiAgICAgICAgOiB1c2VyVmFsdWUgIT0gbnVsbFxuICAgICAgICA/IGZvcm1hdFZhbHVlKHsgLi4uZm9ybWF0VmFsdWVPcHRpb25zLCBkZWNpbWFsU2NhbGUsIHZhbHVlOiBTdHJpbmcodXNlclZhbHVlKSB9KVxuICAgICAgICA6ICcnXG4gICAgKTtcbiAgICBjb25zdCBbZGlydHksIHNldERpcnR5XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbY3Vyc29yLCBzZXRDdXJzb3JdID0gdXNlU3RhdGUoMCk7XG4gICAgY29uc3QgW2NoYW5nZUNvdW50LCBzZXRDaGFuZ2VDb3VudF0gPSB1c2VTdGF0ZSgwKTtcbiAgICBjb25zdCBbbGFzdEtleVN0cm9rZSwgc2V0TGFzdEtleVN0cm9rZV0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgICBjb25zdCBpbnB1dFJlZiA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50PihudWxsKTtcbiAgICB1c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4gaW5wdXRSZWYuY3VycmVudCBhcyBIVE1MSW5wdXRFbGVtZW50KTtcblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgY2hhbmdlIGluIHZhbHVlXG4gICAgICovXG4gICAgY29uc3QgcHJvY2Vzc0NoYW5nZSA9ICh2YWx1ZTogc3RyaW5nLCBzZWxlY3Rpb25TdGFydD86IG51bWJlciB8IG51bGwpOiB2b2lkID0+IHtcbiAgICAgIHNldERpcnR5KHRydWUpO1xuXG4gICAgICBjb25zdCB7IG1vZGlmaWVkVmFsdWUsIGN1cnNvclBvc2l0aW9uIH0gPSByZXBvc2l0aW9uQ3Vyc29yKHtcbiAgICAgICAgc2VsZWN0aW9uU3RhcnQsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBsYXN0S2V5U3Ryb2tlLFxuICAgICAgICBzdGF0ZVZhbHVlLFxuICAgICAgICBncm91cFNlcGFyYXRvcixcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdHJpbmdWYWx1ZSA9IGNsZWFuVmFsdWUoeyB2YWx1ZTogbW9kaWZpZWRWYWx1ZSwgLi4uY2xlYW5WYWx1ZU9wdGlvbnMgfSk7XG5cbiAgICAgIGlmICh1c2VyTWF4TGVuZ3RoICYmIHN0cmluZ1ZhbHVlLnJlcGxhY2UoLy0vZywgJycpLmxlbmd0aCA+IHVzZXJNYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RyaW5nVmFsdWUgPT09ICcnIHx8IHN0cmluZ1ZhbHVlID09PSAnLScgfHwgc3RyaW5nVmFsdWUgPT09IGRlY2ltYWxTZXBhcmF0b3IpIHtcbiAgICAgICAgb25WYWx1ZUNoYW5nZSAmJiBvblZhbHVlQ2hhbmdlKHVuZGVmaW5lZCwgbmFtZSwgeyBmbG9hdDogbnVsbCwgZm9ybWF0dGVkOiAnJywgdmFsdWU6ICcnIH0pO1xuICAgICAgICBzZXRTdGF0ZVZhbHVlKHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgLy8gQWx3YXlzIHNldHMgY3Vyc29yIGFmdGVyICctJyBvciBkZWNpbWFsU2VwYXJhdG9yIGlucHV0XG4gICAgICAgIHNldEN1cnNvcigxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzdHJpbmdWYWx1ZVdpdGhvdXRTZXBhcmF0b3IgPSBkZWNpbWFsU2VwYXJhdG9yXG4gICAgICAgID8gc3RyaW5nVmFsdWUucmVwbGFjZShkZWNpbWFsU2VwYXJhdG9yLCAnLicpXG4gICAgICAgIDogc3RyaW5nVmFsdWU7XG5cbiAgICAgIGNvbnN0IG51bWJlclZhbHVlID0gcGFyc2VGbG9hdChzdHJpbmdWYWx1ZVdpdGhvdXRTZXBhcmF0b3IpO1xuXG4gICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdFZhbHVlKHtcbiAgICAgICAgdmFsdWU6IHN0cmluZ1ZhbHVlLFxuICAgICAgICAuLi5mb3JtYXRWYWx1ZU9wdGlvbnMsXG4gICAgICB9KTtcblxuICAgICAgaWYgKGN1cnNvclBvc2l0aW9uICE9IG51bGwpIHtcbiAgICAgICAgLy8gUHJldmVudCBjdXJzb3IganVtcGluZ1xuICAgICAgICBsZXQgbmV3Q3Vyc29yID0gY3Vyc29yUG9zaXRpb24gKyAoZm9ybWF0dGVkVmFsdWUubGVuZ3RoIC0gdmFsdWUubGVuZ3RoKTtcbiAgICAgICAgbmV3Q3Vyc29yID0gbmV3Q3Vyc29yIDw9IDAgPyAocHJlZml4ID8gcHJlZml4Lmxlbmd0aCA6IDApIDogbmV3Q3Vyc29yO1xuXG4gICAgICAgIHNldEN1cnNvcihuZXdDdXJzb3IpO1xuICAgICAgICBzZXRDaGFuZ2VDb3VudChjaGFuZ2VDb3VudCArIDEpO1xuICAgICAgfVxuXG4gICAgICBzZXRTdGF0ZVZhbHVlKGZvcm1hdHRlZFZhbHVlKTtcblxuICAgICAgaWYgKG9uVmFsdWVDaGFuZ2UpIHtcbiAgICAgICAgY29uc3QgdmFsdWVzOiBDdXJyZW5jeUlucHV0T25DaGFuZ2VWYWx1ZXMgPSB7XG4gICAgICAgICAgZmxvYXQ6IG51bWJlclZhbHVlLFxuICAgICAgICAgIGZvcm1hdHRlZDogZm9ybWF0dGVkVmFsdWUsXG4gICAgICAgICAgdmFsdWU6IHN0cmluZ1ZhbHVlLFxuICAgICAgICB9O1xuICAgICAgICBvblZhbHVlQ2hhbmdlKHN0cmluZ1ZhbHVlLCBuYW1lLCB2YWx1ZXMpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgY2hhbmdlIGV2ZW50XG4gICAgICovXG4gICAgY29uc3QgaGFuZGxlT25DaGFuZ2UgPSAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KTogdm9pZCA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHRhcmdldDogeyB2YWx1ZSwgc2VsZWN0aW9uU3RhcnQgfSxcbiAgICAgIH0gPSBldmVudDtcblxuICAgICAgcHJvY2Vzc0NoYW5nZSh2YWx1ZSwgc2VsZWN0aW9uU3RhcnQpO1xuXG4gICAgICBvbkNoYW5nZSAmJiBvbkNoYW5nZShldmVudCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBmb2N1cyBldmVudFxuICAgICAqL1xuICAgIGNvbnN0IGhhbmRsZU9uRm9jdXMgPSAoZXZlbnQ6IFJlYWN0LkZvY3VzRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pOiBudW1iZXIgPT4ge1xuICAgICAgb25Gb2N1cyAmJiBvbkZvY3VzKGV2ZW50KTtcbiAgICAgIHJldHVybiBzdGF0ZVZhbHVlID8gc3RhdGVWYWx1ZS5sZW5ndGggOiAwO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgYmx1ciBldmVudFxuICAgICAqXG4gICAgICogRm9ybWF0IHZhbHVlIGJ5IHBhZGRpbmcvdHJpbW1pbmcgZGVjaW1hbHMgaWYgcmVxdWlyZWQgYnlcbiAgICAgKi9cbiAgICBjb25zdCBoYW5kbGVPbkJsdXIgPSAoZXZlbnQ6IFJlYWN0LkZvY3VzRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pOiB2b2lkID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdGFyZ2V0OiB7IHZhbHVlIH0sXG4gICAgICB9ID0gZXZlbnQ7XG5cbiAgICAgIGNvbnN0IHZhbHVlT25seSA9IGNsZWFuVmFsdWUoeyB2YWx1ZSwgLi4uY2xlYW5WYWx1ZU9wdGlvbnMgfSk7XG5cbiAgICAgIGlmICh2YWx1ZU9ubHkgPT09ICctJyB8fCB2YWx1ZU9ubHkgPT09IGRlY2ltYWxTZXBhcmF0b3IgfHwgIXZhbHVlT25seSkge1xuICAgICAgICBzZXRTdGF0ZVZhbHVlKCcnKTtcbiAgICAgICAgb25CbHVyICYmIG9uQmx1cihldmVudCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZml4ZWREZWNpbWFscyA9IGZpeGVkRGVjaW1hbFZhbHVlKHZhbHVlT25seSwgZGVjaW1hbFNlcGFyYXRvciwgZml4ZWREZWNpbWFsTGVuZ3RoKTtcblxuICAgICAgY29uc3QgbmV3VmFsdWUgPSBwYWRUcmltVmFsdWUoXG4gICAgICAgIGZpeGVkRGVjaW1hbHMsXG4gICAgICAgIGRlY2ltYWxTZXBhcmF0b3IsXG4gICAgICAgIGRlY2ltYWxTY2FsZSAhPT0gdW5kZWZpbmVkID8gZGVjaW1hbFNjYWxlIDogZml4ZWREZWNpbWFsTGVuZ3RoXG4gICAgICApO1xuXG4gICAgICBjb25zdCBudW1iZXJWYWx1ZSA9IHBhcnNlRmxvYXQobmV3VmFsdWUucmVwbGFjZShkZWNpbWFsU2VwYXJhdG9yLCAnLicpKTtcblxuICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSBmb3JtYXRWYWx1ZSh7XG4gICAgICAgIC4uLmZvcm1hdFZhbHVlT3B0aW9ucyxcbiAgICAgICAgdmFsdWU6IG5ld1ZhbHVlLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChvblZhbHVlQ2hhbmdlICYmIGZvcm1hdFZhbHVlT25CbHVyKSB7XG4gICAgICAgIG9uVmFsdWVDaGFuZ2UobmV3VmFsdWUsIG5hbWUsIHtcbiAgICAgICAgICBmbG9hdDogbnVtYmVyVmFsdWUsXG4gICAgICAgICAgZm9ybWF0dGVkOiBmb3JtYXR0ZWRWYWx1ZSxcbiAgICAgICAgICB2YWx1ZTogbmV3VmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBzZXRTdGF0ZVZhbHVlKGZvcm1hdHRlZFZhbHVlKTtcblxuICAgICAgb25CbHVyICYmIG9uQmx1cihldmVudCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBrZXkgZG93biBldmVudFxuICAgICAqXG4gICAgICogSW5jcmVhc2Ugb3IgZGVjcmVhc2UgdmFsdWUgYnkgc3RlcFxuICAgICAqL1xuICAgIGNvbnN0IGhhbmRsZU9uS2V5RG93biA9IChldmVudDogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xuICAgICAgY29uc3QgeyBrZXkgfSA9IGV2ZW50O1xuXG4gICAgICBzZXRMYXN0S2V5U3Ryb2tlKGtleSk7XG5cbiAgICAgIGlmIChzdGVwICYmIChrZXkgPT09ICdBcnJvd1VwJyB8fCBrZXkgPT09ICdBcnJvd0Rvd24nKSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzZXRDdXJzb3Ioc3RhdGVWYWx1ZS5sZW5ndGgpO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9XG4gICAgICAgICAgcGFyc2VGbG9hdChcbiAgICAgICAgICAgIHVzZXJWYWx1ZSAhPSBudWxsXG4gICAgICAgICAgICAgID8gU3RyaW5nKHVzZXJWYWx1ZSkucmVwbGFjZShkZWNpbWFsU2VwYXJhdG9yLCAnLicpXG4gICAgICAgICAgICAgIDogY2xlYW5WYWx1ZSh7IHZhbHVlOiBzdGF0ZVZhbHVlLCAuLi5jbGVhblZhbHVlT3B0aW9ucyB9KVxuICAgICAgICAgICkgfHwgMDtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBrZXkgPT09ICdBcnJvd1VwJyA/IGN1cnJlbnRWYWx1ZSArIHN0ZXAgOiBjdXJyZW50VmFsdWUgLSBzdGVwO1xuXG4gICAgICAgIGlmIChtaW4gIT09IHVuZGVmaW5lZCAmJiBuZXdWYWx1ZSA8IE51bWJlcihtaW4pKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1heCAhPT0gdW5kZWZpbmVkICYmIG5ld1ZhbHVlID4gTnVtYmVyKG1heCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaXhlZExlbmd0aCA9IFN0cmluZyhzdGVwKS5pbmNsdWRlcygnLicpXG4gICAgICAgICAgPyBOdW1iZXIoU3RyaW5nKHN0ZXApLnNwbGl0KCcuJylbMV0ubGVuZ3RoKVxuICAgICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgICAgIHByb2Nlc3NDaGFuZ2UoXG4gICAgICAgICAgU3RyaW5nKGZpeGVkTGVuZ3RoID8gbmV3VmFsdWUudG9GaXhlZChmaXhlZExlbmd0aCkgOiBuZXdWYWx1ZSkucmVwbGFjZShcbiAgICAgICAgICAgICcuJyxcbiAgICAgICAgICAgIGRlY2ltYWxTZXBhcmF0b3JcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIG9uS2V5RG93biAmJiBvbktleURvd24oZXZlbnQpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUga2V5IHVwIGV2ZW50XG4gICAgICpcbiAgICAgKiBNb3ZlIGN1cnNvciBpZiB0aGVyZSBpcyBhIHN1ZmZpeCB0byBwcmV2ZW50IHVzZXIgdHlwaW5nIHBhc3Qgc3VmZml4XG4gICAgICovXG4gICAgY29uc3QgaGFuZGxlT25LZXlVcCA9IChldmVudDogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBrZXksXG4gICAgICAgIGN1cnJlbnRUYXJnZXQ6IHsgc2VsZWN0aW9uU3RhcnQgfSxcbiAgICAgIH0gPSBldmVudDtcbiAgICAgIGlmIChrZXkgIT09ICdBcnJvd1VwJyAmJiBrZXkgIT09ICdBcnJvd0Rvd24nICYmIHN0YXRlVmFsdWUgIT09ICctJykge1xuICAgICAgICBjb25zdCBzdWZmaXggPSBnZXRTdWZmaXgoc3RhdGVWYWx1ZSwgeyBncm91cFNlcGFyYXRvciwgZGVjaW1hbFNlcGFyYXRvciB9KTtcblxuICAgICAgICBpZiAoc3VmZml4ICYmIHNlbGVjdGlvblN0YXJ0ICYmIHNlbGVjdGlvblN0YXJ0ID4gc3RhdGVWYWx1ZS5sZW5ndGggLSBzdWZmaXgubGVuZ3RoKSB7XG4gICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgICAgICBpZiAoaW5wdXRSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgY29uc3QgbmV3Q3Vyc29yID0gc3RhdGVWYWx1ZS5sZW5ndGggLSBzdWZmaXgubGVuZ3RoO1xuICAgICAgICAgICAgaW5wdXRSZWYuY3VycmVudC5zZXRTZWxlY3Rpb25SYW5nZShuZXdDdXJzb3IsIG5ld0N1cnNvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG9uS2V5VXAgJiYgb25LZXlVcChldmVudCk7XG4gICAgfTtcblxuICAgIC8vIFVwZGF0ZSBzdGF0ZSBpZiB1c2VyVmFsdWUgY2hhbmdlcyB0byB1bmRlZmluZWRcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgaWYgKHVzZXJWYWx1ZSA9PSBudWxsICYmIGRlZmF1bHRWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgIHNldFN0YXRlVmFsdWUoJycpO1xuICAgICAgfVxuICAgIH0sIFtkZWZhdWx0VmFsdWUsIHVzZXJWYWx1ZV0pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIC8vIHByZXZlbnQgY3Vyc29yIGp1bXBpbmcgaWYgZWRpdGluZyB2YWx1ZVxuICAgICAgaWYgKFxuICAgICAgICBkaXJ0eSAmJlxuICAgICAgICBzdGF0ZVZhbHVlICE9PSAnLScgJiZcbiAgICAgICAgaW5wdXRSZWYuY3VycmVudCAmJlxuICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBpbnB1dFJlZi5jdXJyZW50XG4gICAgICApIHtcbiAgICAgICAgaW5wdXRSZWYuY3VycmVudC5zZXRTZWxlY3Rpb25SYW5nZShjdXJzb3IsIGN1cnNvcik7XG4gICAgICB9XG4gICAgfSwgW3N0YXRlVmFsdWUsIGN1cnNvciwgaW5wdXRSZWYsIGRpcnR5LCBjaGFuZ2VDb3VudF0pO1xuXG4gICAgLyoqXG4gICAgICogSWYgdXNlciBoYXMgb25seSBlbnRlcmVkIFwiLVwiIG9yIGRlY2ltYWwgc2VwYXJhdG9yLFxuICAgICAqIGtlZXAgdGhlIGNoYXIgdG8gYWxsb3cgdGhlbSB0byBlbnRlciBuZXh0IHZhbHVlXG4gICAgICovXG4gICAgY29uc3QgZ2V0UmVuZGVyVmFsdWUgPSAoKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIHVzZXJWYWx1ZSAhPSBudWxsICYmXG4gICAgICAgIHN0YXRlVmFsdWUgIT09ICctJyAmJlxuICAgICAgICAoIWRlY2ltYWxTZXBhcmF0b3IgfHwgc3RhdGVWYWx1ZSAhPT0gZGVjaW1hbFNlcGFyYXRvcilcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gZm9ybWF0VmFsdWUoe1xuICAgICAgICAgIC4uLmZvcm1hdFZhbHVlT3B0aW9ucyxcbiAgICAgICAgICBkZWNpbWFsU2NhbGU6IGRpcnR5ID8gdW5kZWZpbmVkIDogZGVjaW1hbFNjYWxlLFxuICAgICAgICAgIHZhbHVlOiBTdHJpbmcodXNlclZhbHVlKSxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdGF0ZVZhbHVlO1xuICAgIH07XG5cbiAgICBjb25zdCBpbnB1dFByb3BzOiBSZWFjdC5Db21wb25lbnRQcm9wc1dpdGhSZWY8J2lucHV0Jz4gPSB7XG4gICAgICB0eXBlOiAndGV4dCcsXG4gICAgICBpbnB1dE1vZGU6ICdkZWNpbWFsJyxcbiAgICAgIGlkLFxuICAgICAgbmFtZSxcbiAgICAgIGNsYXNzTmFtZSxcbiAgICAgIG9uQ2hhbmdlOiBoYW5kbGVPbkNoYW5nZSxcbiAgICAgIG9uQmx1cjogaGFuZGxlT25CbHVyLFxuICAgICAgb25Gb2N1czogaGFuZGxlT25Gb2N1cyxcbiAgICAgIG9uS2V5RG93bjogaGFuZGxlT25LZXlEb3duLFxuICAgICAgb25LZXlVcDogaGFuZGxlT25LZXlVcCxcbiAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgZGlzYWJsZWQsXG4gICAgICB2YWx1ZTogZ2V0UmVuZGVyVmFsdWUoKSxcbiAgICAgIHJlZjogaW5wdXRSZWYsXG4gICAgICAuLi5wcm9wcyxcbiAgICB9O1xuXG4gICAgaWYgKGN1c3RvbUlucHV0KSB7XG4gICAgICBjb25zdCBDdXN0b21JbnB1dCA9IGN1c3RvbUlucHV0O1xuICAgICAgcmV0dXJuIDxDdXN0b21JbnB1dCB7Li4uaW5wdXRQcm9wc30gLz47XG4gICAgfVxuXG4gICAgcmV0dXJuIDxpbnB1dCB7Li4uaW5wdXRQcm9wc30gLz47XG4gIH1cbik7XG5cbkN1cnJlbmN5SW5wdXQuZGlzcGxheU5hbWUgPSAnQ3VycmVuY3lJbnB1dCc7XG5cbmV4cG9ydCBkZWZhdWx0IEN1cnJlbmN5SW5wdXQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=